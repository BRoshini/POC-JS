typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("_Ewa");_Ewa.um=function(){};_Ewa.og=function(){};_Ewa.um.registerClass("_Ewa.um");_Ewa.og.registerClass("_Ewa.og");Type.registerNamespace("_Ewa");_Ewa.Ey=function(){};_Ewa.bdU=function(){};Type.registerNamespace("Common.App.CoauthTelemetry");Common.App.CoauthTelemetry.e=function(n){this.g=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);this.c={};this.d={};this.f=n};Common.App.CoauthTelemetry.e.prototype={e:null,f:null,b:null,a:function(n){var t=new($$sc.D.$$(Number)),i=this;return this.l().CW(function(){n in i.c?t.d(i.c[n]):i.d[n]=t}),t.a},l:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Object));var n=this;return this.f.CW(function(){n.e=n.f.a();n.e.b(n.h);n.i();n.b.b(null)}),this.b.a},i:function(){var t=this.e.a(),n;for(t.sort(this.g),this.c={},n=0;n<t.length;n++){if(!t[n]||!t[n].h())return;this.j(this.c,t[n].a(),n)}},j:function(n,t,i){n[t]=i;t in this.d&&(this.d[t].d(i),delete this.d[t])},m:function(){this.i()},k:function(n,t){var i=n,r=t;return i.p>r.p?1:i.p<r.p?-1:0}};Common.App.CoauthTelemetry.d=function(n,t,i,r,u,f,e,o,s){this.u=Function.createDelegate(this,this.y);this.n=Function.createDelegate(this,this.z);this.v=n;this.b=new($$sc.D.$$(Common.eH));this.g=i;this.e=t;this.p=r;this.s=u;this.f=f;this.l=e;this.q=o;this.j=!1;this.k=!1;this.d=0;this.i=1;this.h=s;this.m=this.g.a("PeoplesWellExtraButtonInfoIsEnabled");this.o=$$as(String,Common.a.d.Application)||""};Common.App.CoauthTelemetry.d.prototype={v:null,b:null,e:null,g:null,p:null,s:null,f:null,l:null,q:null,m:!1,c:null,r:null,t:null,i:0,k:!1,j:!1,d:0,h:null,o:null,a:function(){var n=this;$$sc.a.WAA.call(null,this.l,this.e,this.f).CW(function(){n.c=n.l.a();n.r=n.e.a();n.t=n.f.a();$$sc.a.WAA.call(null,n.e.a().bi(),n.f.a().a()).CW(function(){n.i=n.r.bi().a();n.d=n.t.a().a();n.c.b(n.n);n.c.a().length&&n.w()})})},z:function(){this.w()},w:function(){var n=this.q(this.c.a());n?(this.c.c(this.n),this.x(this.j)):this.b.d(1);this.j=!0},x:function(n){var t,i;if(this.k){t=this;this.b.a.CW(function(){Diag.a.a(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Common.eH.toString(t.b.a.a()))});return}this.k=!0;i=!this.i&&!n;this.A(i)},A:function(n){n?this.p.a(4,this.u,3):this.b.d(1)},y:function(){var i=this.s.b("AppInitStatus_"+Common.App.b.toString(4)),t,n;Diag.a.b(42259235,325,!!this.d,null);t=this.d-i;n={};n.InteractiveTime=i;n.ReactRenderComplete=this.d;n.HadTabSwitch=this.h();n.IsModernGallery=this.m;Diag.a.a(594883104,325,50,Common.J.b(n));this.m?(Diag.a.a(42062997,325,15,t.toString()),this.b.d(this.B(t)?3:2)):Diag.a.a(594883103,325,15,t.toString())},B:function(n){var f=this.g.c("CoauthorGalleryTimeToRenderDurationMs",1e4),t=n>f,u=this.o==="Word",i="CoauthGalleryExperienceDegraded",r;return this.h()?(Diag.a.a(50455714,325,50,t.toString()),!1):(u&&Common.i.a().recordKpiUsage(i,0,"wordcollabrel",null),t&&(r="CoauthorGalleryTimeToRenderDurationIsTooLong",u?Common.i.a().recordKpiFailure(i,r,!1,!0,null):Common.i.a().recordQosError(r,[i],!1,!0,!0,!1,null),Diag.a.a(42062998,325,15,n.toString())),t)}};Common.App.CoauthTelemetry.a=function(n,t){this.c=Function.createDelegate(this,this.f);this.b=n;this.d=t};Common.App.CoauthTelemetry.a.a=function(n){for(var t,i,r=null,f=n,e=f.length,u=0;u<e;++u)if(t=f[u],t)if(i=t.f()||!t.b()?t.a():t.b().toUpperCase(),r){if(r!==i)return!0}else r=i;return!1};Common.App.CoauthTelemetry.a.prototype={a:null,d:null,b:null,e:function(){var n=this;this.b.CW(function(){n.a=n.b.a();n.a.b(n.c)})},f:function(){Common.App.CoauthTelemetry.a.a(this.a.a())&&(this.a.c(this.c),this.d.IsRealCoauthSession=!0)}};Common.App.CoauthTelemetry.g=function(){};Common.App.CoauthTelemetry.g.a=function(){Common.App.a.a().a(new Common.App.CoauthTelemetry.g,0,!1)};Common.App.CoauthTelemetry.g.prototype={a:function(){return"Common.App.CoauthTelemetry"},c:function(n){var u=this,t,i,r;n.c(Common.App.CoauthTelemetry.a,null).c(Common.App.CoauthTelemetry.h,null).a().b(function(){return new Common.App.CoauthTelemetry.a(Common.Utils.b.a(Common.cf,n.b(Common.cf,null)),Common.a.f)});t=this;n.c(Common.App.CoauthTelemetry.d,null).c(Common.fO,null).a().b(function(){return new Common.App.CoauthTelemetry.d(Common.a.c(),Common.Utils.b.a(Common.dq,n.b(Common.dq,null)),Common.a.a,Common.App.AppLifecycleManager.get_instance(),Common.bm.a(),Common.Utils.b.a(Common.el,n.b(Common.el,null)),Common.Utils.b.a(Common.cf,n.b(Common.cf,null)),Common.App.CoauthTelemetry.a.a,function(){return t.d()})});i=this;n.c(Common.App.CoauthTelemetry.f,null).c(Common.App.CoauthTelemetry.b,null).a().b(function(){return new Common.App.CoauthTelemetry.f(Common.Utils.b.a(Common.dq,n.b(Common.dq,null)),Common.Utils.b.a(Common.em,n.b(Common.em,null)),Common.Utils.b.a(Common.cf,n.b(Common.cf,null)),Common.App.AppLifecycleManager.get_instance(),n.a(Common.App.CoauthTelemetry.c,null),Common.bm.a(),function(){return i.d()},Common.a.a,null,Common.i.a())});r=this;n.c(Common.App.CoauthTelemetry.e,null).c(Common.App.CoauthTelemetry.c,null).a().b(function(){return new Common.App.CoauthTelemetry.e(Common.Utils.b.a(Common.cf,n.b(Common.cf,null)))})},b:function(){var n=this;Common.a.a.k(function(){Common.Utils.a.a().a(Common.App.CoauthTelemetry.a,null).e();Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.Utils.a.a().a(Common.fO,null).a();Common.a.a.a("CashTelemetryIsEnabled")&&(Common.Utils.a.a().a(Common.App.CoauthTelemetry.b,null),Common.Utils.a.a().a(Common.App.CoauthTelemetry.c,null))})},d:function(){if(Common.ba.b()&&Common.bm.a().c("UserActions")){var n=Common.bm.a().b("UserActions");return n.VisiToggled>0}return!1}};Common.App.CoauthTelemetry.f=function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v;this.B=Function.createDelegate(this,this.M);this.z=Function.createDelegate(this,this.J);this.A=Function.createDelegate(this,this.L);this.t={};this.i={};this.q=new($$sc.v.$$(String));c=this;this.x=new($$sc.z.$$(Number))(function(){return o.e("PresenceBootLatencyThreshold",1e4)});l=this;this.p=new($$sc.z.$$(Number))(function(){return o.e("PresenceBootLatencyCutoffThreshold",6e4)});a=this;this.w=new($$sc.z.$$(Number))(function(){return o.e("PresenceLightupLatencyThreshold",2e3)});v=this;this.o=new($$sc.z.$$(Number))(function(){return o.e("PresenceLightupLatencyCutoffThreshold",1e4)});this.n=r;this.s=u;this.j=n;this.m=t;this.l=i;this.r=f;this.d=s;this.h=e;this.k=h;this.g=!1;this.F()};Common.App.CoauthTelemetry.f.prototype={j:null,m:null,f:null,l:null,e:null,g:!1,d:null,c:null,n:null,s:null,b:null,r:null,u:0,v:0,x:null,p:null,w:null,o:null,h:null,k:null,a:function(n,t,i,r){i&&(Diag.a.b(42274970,302,!this.d||this.d===i,"_myClientId is already set and you are trying to update it to something different"),this.d=i);var u=new($$sc.D.$$(Boolean)),f=this;return this.F().CW(function(){f.K(n);f.H(u,n,t,r)}),u.a},C:function(){return this.d||"{"+Common.a.j+"}"},F:function(){var i,n,t;return this.c?this.c.a:(this.c=new($$sc.D.$$(Object)),this.h()&&Diag.a.a(50951700,302,15,"TabSwitched Session"),i=this,this.j.CW(function(){var n=i.j.a(),t=n.bi(),r=n.bY();r.CW(function(){t.CW(function(){i.k&&i.k.addQosPillar(Common.QosPillarName.toString(4));i.N(t.a(),r.a());i.c.b(null)})})}),n=this,this.m.CW(function(){n.f=n.m.a();n.f.e(n.A);n.f.a(n.z)}),t=this,this.l.CW(function(){t.e=t.l.a();t.e.b(t.B);t.e.a().length>0&&t.G()}),this.c.a)},D:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Number));var n=this;return this.n.a(4,function(){var t=n.r.b("AppInitStatus_"+Common.App.b.toString(4));n.b.d(t)},3),this.b.a},L:function(n,t){if(!this.g&&t.a===2){var r=this.D(),i=this;r.CW(function(){var t=r.a(),u=Date.now()-t,n={};n.clientId=i.C();n.bootTime=u;i.g=!0;i.f.k(15,n,!1)})}},J:function(n,t){if(t.a===15){var r=Date.now(),i=t.b,u=i.clientId,f=i.bootTime,e=this.y(u);e.n(r-f)}},M:function(){this.G()},G:function(){for(var n,r,e,u,o=Date.now(),s=this.e.a(),t=new($$sc.v.$$(String)),f=s,h=f.length,i=0;i<h;++i)n=f[i],this.q.c(n.a())||(this.q.b(n.a()),t.b(n.a()));if(t.f.length>0)for(r=t.$$lge();r.$$mn();)e=r.$$cu(),u=this.y(e),u.l()||u.p(o)},K:function(n){var t=this.y(n);t.k()||t.o(Date.now())},y:function(n){if(!(n in this.i))return this.i[n]=new Common.App.CoauthTelemetry.j(n,this.w,this.o);return this.i[n]},N:function(n,t){this.u=n;this.v=t?t:(new Date).getTime()},H:function(n,t,i,r){var f=i?i.getTime():(new Date).getTime(),u;if(!(t in this.t)){u=new Common.App.CoauthTelemetry.i(t,this.I(),f,this.E(this.C()),this.E(t),this.x,this.p,r,this.h);this.t[t]=u;u.n(n);return}n.f()},I:function(){return this.u===1?$$sc.a.a(Number,this.v):this.D()},E:function(n){return this.s.a(n)}};Common.App.CoauthTelemetry.i=function(n,t,i,r,u,f,e,o,s){this.k=n;this.f=t;this.a=i;this.b=r;this.d=u;this.g=f;this.e=e;this.j=o;this.i=s;this.h=$$as(String,Common.a.d.Application)||""};Common.App.CoauthTelemetry.i.prototype={c:0,f:null,g:null,e:null,l:!1,h:null,a:0,b:null,d:null,j:0,k:null,i:null,n:function(n){var t=this;$$sc.a.WAA(this.f,this.b,this.d).CW(function(){var r,i,o,s,u,h;if(t.b.a()<=t.d.a()){n.d(!1);return}t.c=t.f.a();r=t.a-t.c;i=new Common.App.CoauthTelemetry.PL;i.id=t.k;i.et=t.a;i.st=t.c;i.d=t.a-t.c;i.mp=t.b.a();i.tp=t.d.a();i.ct=t.m(t.j);i.vc=t.i();var f=JSON.stringify(i),c=t.h==="Word",e="PresenceExperienceDegraded";Diag.a.a(42078597,302,15,f);c&&(o=new Map,o.set("data",f),Common.i.a().recordKpiUsage(e,0,"wordcollabrel",o));r>t.g.a()&&!t.l&&!i.vc&&(t.l=!0,n.d(!0),u=(s=new Common.V,s.extendedProperties=new Map,s),u.extendedProperties.set("data",f),h="PresenceRenderDurationIsTooLong",c?Common.i.a().recordKpiFailure(e,h,!1,!0,u):Common.i.a().recordQosError(h,[e],!1,!0,!1,!1,u),r<t.e.a()&&Diag.a.a(42078598,302,15,Common.App.CoauthTelemetry.VD.a(r,t.g.a(),t.e.a())));n.a.b>3||n.d(!1)})},m:function(n){switch(n){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}};Common.App.CoauthTelemetry.PL=function(){};Common.App.CoauthTelemetry.PL.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};Common.App.CoauthTelemetry.VD=function(){};Common.App.CoauthTelemetry.VD.a=function(n,t,i){var r=new Common.App.CoauthTelemetry.VD;return r.d=n,r.vt=t,r.ct=i,JSON.stringify(r)};Common.App.CoauthTelemetry.VD.prototype={d:0,vt:0,ct:0};Common.App.CoauthTelemetry.j=function(n,t,i){this.i=n;this.e=t;this.d=i;this.f=$$as(String,Common.a.d.Application)||""};Common.App.CoauthTelemetry.j.prototype={i:null,a:0,c:0,b:0,f:null,e:null,d:null,h:0,g:0,n:function(n){return this.a=n,this.j(),n},p:function(n){return this.c=n,this.j(),n},o:function(n){return this.b=n,this.j(),n},l:function(){return!!this.h},k:function(){return!!this.g},j:function(){!this.l()&&this.a&&this.c&&(this.h=this.m(this.c,"CoauthGalleryLightupDurationTooLong"));!this.k()&&this.a&&this.b&&(this.g=this.m(this.b,"CanvasPresenceLightupDurationTooLong"))},m:function(n,t){var u=n-this.a,i=new Common.App.CoauthTelemetry.PL,o,s,r,h;i.id=this.i;i.et=n;i.st=this.a;i.d=u;var f=JSON.stringify(i),c=this.f==="Word",e=t==="CanvasPresenceLightupDurationTooLong"?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";return(t==="CanvasPresenceLightupDurationTooLong"?Diag.a.a(572289499,302,15,f):Diag.a.a(571524118,302,15,f),c&&(o=new Map,o.set("data",f),Common.i.a().recordKpiUsage(e,0,"wordcollabrel",o)),u>this.e.a())?(r=(s=new Common.V,s.extendedProperties=new Map,s),r.extendedProperties.set("data",f),h=u<this.d.a(),r.extendedProperties.set("cash",h?"true":"false"),c?Common.i.a().recordKpiFailure(e,t,!1,!0,r):Common.i.a().recordQosError(t,[e],!1,!0,!1,!1,r),Diag.a.a(572289500,302,15,Common.App.CoauthTelemetry.VD.a(u,this.e.a(),this.d.a())),h?2:1):3}};Common.App.CoauthTelemetry.e.registerClass("Common.App.CoauthTelemetry.e",null,Common.App.CoauthTelemetry.c);Common.App.CoauthTelemetry.d.registerClass("Common.App.CoauthTelemetry.d",null,Common.fO);Common.App.CoauthTelemetry.a.registerClass("Common.App.CoauthTelemetry.a",null,Common.App.CoauthTelemetry.h);Common.App.CoauthTelemetry.f.registerClass("Common.App.CoauthTelemetry.f",null,Common.App.CoauthTelemetry.b);Common.App.CoauthTelemetry.i.registerClass("Common.App.CoauthTelemetry.i");Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");Common.App.CoauthTelemetry.VD.registerClass("Common.App.CoauthTelemetry.VD");Common.App.CoauthTelemetry.j.registerClass("Common.App.CoauthTelemetry.j");Common.App.CoauthTelemetry.g.a();Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.l=function(){};Common.App.CollabControls.l.registerInterface("Common.App.CollabControls.l");Common.App.CollabControls.m=function(){};Common.App.CollabControls.c=function(){};Common.App.CollabControls.c.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};Common.App.CollabControls.c.registerEnum("Common.App.CollabControls.c",!1);Common.App.CollabControls.i=function(n){this.K=Function.createDelegate(this,this.bn);Common.App.CollabControls.i.initializeBase(this);this.l=n};Common.App.CollabControls.i.a=function(n,t){return n+(t?"Rtl":"")};Common.App.CollabControls.i.prototype={l:null,bv:function(){return this.l},bl:function(){return this.l.style.visibility==="visible"},H:function(n){return this.l.style.visibility=n?"visible":"hidden",n},bm:function(n){return this.l.dir=n?"rtl":"ltr",n},dispose:function(){this.l&&this.l.parentNode&&this.l.parentNode.removeChild(this.l);this.l=null;Common.bc.prototype.dispose.call(this)},ba:function(n){return this.l.ownerDocument.createElement(n)},bn:function(){return!0}};Common.App.CollabControls.e=function(n,t){Common.App.CollabControls.e.initializeBase(this);this.a=n;this.b=t};Common.App.CollabControls.e.prototype={a:0,b:null};Common.App.CollabControls.f=function(n,t,i){this.O=Function.createDelegate(this,this.S);this.z=Function.createDelegate(this,this.br);this.o=[];Common.App.CollabControls.f.resolveInheritance();this.a=this.bv;Common.App.CollabControls.f.initializeBase(this,[n]);this.D={};this.Q=i;this.E=i.b(8,!1);this.P=i.b(15,!1);this.A=i.b(12,0);this.t=i.b(6,0);this.bb=t;this.R=i.b(16,null);this.V=i.b(17,!1);this.I=0;this.W=new Common.App.CollabControls.j(this.E,this.V);this.B=this.be();this.M=!1;this.q=[];this.C=[];this.l.id=Common.App.CollabControls.f.b();this.l.className=Common.App.CollabControls.i.a("prControl",this.E);this.A&&(this.l.style.zIndex=this.A);this.bm(this.E);this.bt(t);this.r=this.ba("div");this.r.className="prFlyoutContainer";this.l.appendChild(this.r);this.p=[];this.u=new Common.App.CollabControls.k(this.p,this.l,this.t,4,6,32,this.E);this.x=i.b(9,null);this.x.a("msospPointerDown",this.u.a,this.z);this.x.a("msospPointerOver",this.u.a,this.z);this.x.a("msospPointerOut",this.u.a,this.z)};Common.App.CollabControls.f.b=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.f.a++)};Common.App.CollabControls.f.prototype={E:!1,w:!1,L:!1,s:!1,bb:0,I:0,F:!1,P:!1,V:!1,M:!1,D:null,r:null,u:null,q:null,C:null,W:null,B:0,x:null,Q:null,R:null,c:function(){return Common.B.c(this.o)},p:null,A:0,t:0,v:function(){return this.p?this.p.length:0},y:function(){return this.v()>0?this.p[0].b:5},bd:function(){return this.y()===3&&!this.w},dispose:function(){var t;if(this.bd()){this.M=!0;return}if(this.p)for(var i=this.p,r=i.length,n=0;n<r;++n)t=i[n],t.A(this.O),System.a.a(t);this.p=null;this.x.b("msospPointerDown",this.u.a,this.z);this.x.b("msospPointerOver",this.u.a,this.z);this.x.b("msospPointerOut",this.u.a,this.z);Common.App.CollabControls.i.prototype.dispose.call(this)},i:function(){this.G(!1);this.H(!0)},h:function(){this.H(!0);this.bc();this.w=!0},e:function(){this.bi(5);this.bf();this.u.i(this.y(),this.F)},b:function(n){var u=this.y(),f=this.w,i,r,t;if(n.n||(n.n=(Common.App.CollabControls.f.a++).toString()),i=0,n.n in this.D&&(i=this.N(n.n),i>=0)){if(r=this.o[i],r.r===n.r&&r.o===n.o)return;this.f(n.n)}this.e();t=new Common.App.CollabControls.a(this.ba("div"),this.Q);t.D(this.O);this.r.insertBefore(t.l,this.r.firstChild);this.D[n.n]=t;Array.add(this.o,n);Array.add(this.p,t);this.bk(u,f);this.H(!0)},f:function(n){if(this.bd()){Array.add(this.C,n);return}var t=this.y(),i=this.w;this.e();this.bj(n);this.bk(t,i)},bk:function(n,t){this.o.length<=0?this.e():n===3&&t?this.h():this.i()},g:function(n,t){t?this.bo(n):this.bh(n)},d:function(n){n!==this.L&&(this.L=n,this.Y(n))},j:function(n,t){this.l.style.top=t+"px";this.l.style.left=n+"px"},G:function(n){var i,t;if(!n||this.s){this.L&&this.Y(!0);var r=Math.min(3,this.v())-1,u=0,f=1,e=0;for(this.F&&(u=this.B,f=-1,e=-this.t),i=this.v()-1;i>r;i--)this.p[i].C(this.o[i],r*-4*f+e,0,!0,!1,!0,u);for(t=r;t>=0;t--)this.p[t].C(this.o[t],t*-4*f+e,0,t>0,Array.contains(this.q,this.o[t].n),t!==this.I,u);this.I=0;this.u.i(0,this.F);this.l.style.zIndex=this.A;this.w=!1;this.bi(0);this.M&&this.dispose()}},bc:function(){var t,i,r,u,f,e,n;for(this.L&&this.Y(!1),this.l.style.zIndex=this.A+1,this.bu(u={val:i},f={val:t},e={val:r}),i=u.val,t=f.val,r=e.val,n=0;n<this.v();n++)this.p[n].V(this.o[n],i,t+(this.t+2)*n,n!==this.I,r)},bf:function(){var t=0,i=0,n;for(this.F&&(t=this.B,i=-6),n=0;n<this.v();n++)this.p[n].M(this.o[n],i,t);this.l.style.zIndex=this.A;this.w=!1;this.H(!1);this.M&&this.dispose()},X:function(n){if(n){this.s=!0;var t=this;$$sc.a.b(n).CW(function(){t.P?t.bq():t.G(!0);t.s=!1})}else this.P?this.e():this.G(!1)},bq:function(){this.s&&this.e()},S:function(n,t){var i=this.y(),r;t.a===2||t.a===4&&i!==3?(this.s&&(this.s=!1),i!==3&&(this.bc(),t.b.b===3&&this.X(2e3))):t.a===4&&i===3?(this.s&&(this.s=!1),this.X(0)):t.a===3&&i===3&&(this.w||(this.v()>1?(this.s=!0,r=this,$$sc.a.b(250).CW(function(){r.G(!0);r.s=!1})):this.X(0)));this.k("InteractivityChanged",t,null)},br:function(n){return n.b===3?this.S(this,new Common.App.CollabControls.e(4,n)):n.d==="msospPointerOver"?this.S(this,new Common.App.CollabControls.e(2,n)):n.d==="msospPointerOut"&&this.S(this,new Common.App.CollabControls.e(3,n)),!1},bt:function(n){this.l.style.width=n+"px";this.l.style.height=this.t+"px"},bj:function(n){var t,r,i;(this.bh(n),t=this.N(n),t<0)||(r=this.o[t],Array.removeAt(this.o,t),delete this.D[r.n],i=this.p[t],this.r.removeChild(i.l),this.Q.b(18,!1)&&i.A(this.O),Array.removeAt(this.p,t),i.dispose())},bi:function(n){if(this.C.length){this.bl()&&this.bf();for(var t=0;t<this.C.length;t++)this.bj(this.C[t]);Array.clear(this.C);this.o.length<=0||n===5?this.e():n||this.i()}},N:function(n){for(var t=0;t<this.o.length;t++)if(this.o[t].n===n)return t;return-1},bg:function(n){var t,r,i;n in this.D&&(t=this.N(n),t&&(r=this.o[t],i=this.D[n],Array.removeAt(this.o,t),Array.insert(this.o,0,r),Array.removeAt(this.p,t),Array.insert(this.p,0,i),this.r.removeChild(i.l),this.r.appendChild(i.l),this.G(!1)))},bo:function(n){if(this.N(n)===-1){Diag.a.a(41706451,302,15,"Cannot set active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(this.o[0].n===n)return;Array.remove(this.q,n)}Array.add(this.q,n);this.bg(n);this.y()!==1&&this.G(!1)},bh:function(n){if(this.N(n)===-1){Diag.a.a(41706452,302,50,"Cannot remove active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(Array.remove(this.q,n),this.o[0].n===n&&this.q.length>0){var t=this.q[this.q.length-1];this.bg(t)}this.o[0].n===n&&this.y()===1&&this.G(!1)}},Y:function(n){n?Sys.UI.DomElement.addCssClass(this.r,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.r,"prBackgroundSelection")},bu:function(n,t,i){var u,f,r;if(n.val=0,t.val=0,i.val=this.B,this.R){if(u=this.R(this),!u)return;f=this.y()===4;r=this.W.g(this.v(),f?6:this.t,this.t,150,2,this.l,u);t.val=r.a;this.I=this.bp(r.c,r.a);i.val=r.b;i.val!==this.B&&(this.bs(i.val),this.l.dir=i.val===3?"rtl":"ltr",this.B=i.val);i.val!==this.be()?(n.val=f?-6:-this.t,this.F=!0):this.F=!1}},bp:function(n,t){if(n===1)return this.v()-1;var i=Math.abs(t);return i>0?i/(this.t+2):0},bs:function(n){for(var t=0;t<this.v();t++)this.p[t].S(n)},be:function(){return this.E?3:4}};Common.App.CollabControls.b=function(){};Common.App.CollabControls.b.h=function(n,t,i,r){return Common.App.CollabControls.b.i(n,t,i,r)};Common.App.CollabControls.b.i=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"svg");return u.setAttribute("viewBox",String.format(Common.App.CollabControls.b.f,Common.App.CollabControls.b.c,Common.App.CollabControls.b.b)),u.appendChild(Common.App.CollabControls.b.j(n,t,i,r)),u};Common.App.CollabControls.b.j=function(n,t,i,r){var e=Common.App.CollabControls.b.c/n,h=t/2*e,c=Common.App.CollabControls.b.b/2,o=0,f,u,s;for(r&&(o=(n-t*3-i*4)*e/2),f=document.createElementNS(Common.App.CollabControls.b.a,"g"),f.setAttribute("class",Common.App.CollabControls.b.e),u=1;u<=3;u++)s=o+(u*(t+i)-t/2)*e,f.appendChild(Common.App.CollabControls.b.g(u,h,s,c));return f};Common.App.CollabControls.b.g=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"circle");return u.setAttribute("class",String.format("{0}-{1}",Common.App.CollabControls.b.d,n)),u.setAttribute("cx",String.format("{0}",i)),u.setAttribute("cy",String.format("{0}",r)),u.setAttribute("r",String.format("{0}",t)),u};Common.App.CollabControls.g=function(n){this.b=n;this.b.d(10,Common.j.a());this.b.d(9,Common.f.a());this.b.d(6,20);this.b.d(13,Common.bk.a());this.b.d(17,!1)};Common.App.CollabControls.g.prototype={b:null,a:function(n,t){return this.b.d(15,t),new Common.App.CollabControls.f(n,20,this.b)}};Common.App.CollabControls.a=function(n,t){this.u=Function.createDelegate(this,this.Q);this.t=Function.createDelegate(this,this.P);this.s=Function.createDelegate(this,this.O);this.r=Function.createDelegate(this,this.N);Common.App.CollabControls.a.initializeBase(this,[n]);this.q=t.b(8,!1);this.f=t.b(6,0);this.w=t.b(15,!1);this.z=t;this.o=0;this.l=n;this.l.className=Common.App.CollabControls.a.h;this.a=document.createElement("span");this.l.appendChild(this.a);this.v=Common.App.CollabControls.b.h(t.b(6,0),4,2,!0);this.R(t);this.b=5};Common.App.CollabControls.a.prototype={g:null,e:null,j:null,z:null,a:null,p:null,v:null,f:0,q:!1,w:!1,i:null,o:0,c:null,D:function(n){this.m("InteractivityChanged",n)},A:function(n){this.n("InteractivityChanged",n)},y:null,b:0,dispose:function(){this.l&&(this.g.b("click",this.l,this.r),this.g.b("dblclick",this.l,this.K),this.e.b("msospPointerDown",this.l,this.s),this.e.b("msospPointerOut",this.l,this.t),this.e.b("msospPointerOver",this.l,this.u),this.j.c(this.l,this.K));Common.App.CollabControls.i.prototype.dispose.call(this)},R:function(n){this.g=n.b(10,null);this.g.a("click",this.l,this.r);this.g.a("dblclick",this.l,this.K);this.e=n.b(9,null);this.e.a("msospPointerOver",this.l,this.u);this.e.a("msospPointerOut",this.l,this.t);this.e.a("msospPointerDown",this.l,this.s);this.j=n.b(13,null);this.j.a(this.l,this.K)},M:function(n,t,i){this.w&&n?this.W(n,t,i):(this.b===3&&this.B(),this.H(!1),this.b=5)},W:function(n,t,i){this.x(n,t,15,4,!1,i)},C:function(n,t,i,r,u,f,e){var o=r?2:u?1:0;this.x(n,t,i+20,o,f,e)},V:function(n,t,i,r,u){this.x(n,t,i+20,3,r,u)},x:function(n,t,i,r,u,f){n&&(r!==this.b||!this.L(t,i))&&(this.E(r,u,f),this.G(n,r,f),this.b=r,f!==4&&(f||this.q)?this.l.style.right=t+"px":this.l.style.left=t+"px",this.l.style.top=i+"px",this.H(!0))},G:function(n,t,i){var r,u;this.y=n;Common.p.h(this.a);Common.N.g(this.a);this.a.id="fly_"+n.n;this.a.style.backgroundColor=n.r;t!==4?(this.a.style.height=this.f+"px",this.a.style.lineHeight=this.f+"px",Common.N.e(this.a,"border-radius",this.f+"px")):i!==4&&(i||this.q)?this.a.style.right="0px":this.a.style.left="0px";t!==2&&(t===4?Common.p.m(this.a,""):t===1?this.a.appendChild(this.v):(this.a.setAttribute("dir","auto"),r=Common.d.Z(n.o,!1,!1),!n.w&&r||t?(u=n.o,t||(u=r,Common.N.e(this.a,"text-align","center")),Common.p.m(this.a,u)):(this.p||(this.p=this.I()),this.a.appendChild(this.p),Common.N.e(this.a,"text-align","start"))))},N:function(n){return this.b?(this.b===3&&Diag.a.a(50436114,302,50,"User clicked on presence pill."),!1):(this.k("InteractivityChanged",new Common.App.CollabControls.e(1,n),null),!0)},P:function(n){return this.b===3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(3,n),null),!1},Q:function(n){return n.b!==3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(2,n),null),!1},O:function(n){return n.b!==3?!0:(this.k("InteractivityChanged",new Common.App.CollabControls.e(4,n),null),!1)},I:function(){var n=document.createElement("img");return n.setAttribute("src",Common.E.c("doughperson_white_glyph.svg")),n.setAttribute("Unselectable","on"),n.setAttribute("role","presentation"),Common.O.c(this.f,this.f,null,null,Common.App.CollabControls.a.k,"",!1,"",this.l.ownerDocument,n)},E:function(n,t,i){if(!this.h(this.b)||!this.h(n)){Sys.UI.DomElement.removeCssClass(this.l,this.i);switch(this.b){case 4:n===3?this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.f):this.h(n)&&this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.f);break;case 3:n===4?this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.e):this.h(n)&&(t&&this.B(),this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.e,t?Common.App.CollabControls.a.j:""));break;case 0:case 1:case 2:if(n===4)this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.c);else if(n===3){t&&this.F();var r=i===3?Common.App.CollabControls.a.m:Common.App.CollabControls.a.l;this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.c,t?Common.App.CollabControls.a.g:"",r)}break;default:n===4?this.d(Common.App.CollabControls.a.d):n===3?this.d(Common.App.CollabControls.a.b):this.h(n)&&this.d(Common.App.CollabControls.a.a)}}},d:function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];this.i=t.join(" ");Sys.UI.DomElement.addCssClass(this.l,this.i)},F:function(){var n=this;this.o=window.setTimeout(function(){n.l&&(n.c=n.l.cloneNode(!0),n.l.parentNode.appendChild(n.c),n.l.style.zIndex=2,n.c.style.zIndex=1)},300)},B:function(){if(window.clearTimeout(this.o),this.c){Sys.UI.DomElement.removeCssClass(this.c,Common.App.CollabControls.a.c+" "+Common.App.CollabControls.a.g);Sys.UI.DomElement.addCssClass(this.c,Common.App.CollabControls.a.i);var n=this;$$sc.a.b(300).CW(function(){n.l&&n.l.parentNode===n.c.parentNode&&n.l.parentNode.removeChild(n.c)});Common.N.d(this.l,"z-index")}},h:function(n){return!n||n===1||n===2},L:function(n,t){var i=Common.N.b(this.l.style.left),r=Common.N.b(this.l.style.top);return i===n&&r===t},S:function(n){var t,i;n===3&&Common.N.c(this.l,"left")?(t=Common.N.b(this.l.style.left),Common.N.d(this.l,"left"),this.l.style.right=-1*t+"px"):n===4&&Common.N.c(this.l,"right")&&(i=Common.N.b(this.l.style.right),Common.N.d(this.l,"right"),this.l.style.left=-1*i+"px")}};Common.App.CollabControls.j=function(n,t){this.a=n;this.b=t};Common.App.CollabControls.j.prototype={a:!1,b:!1,g:function(n,t,i,r,u,f,e){var l=e.y,a=e.height,d=this.f(f),h=d,g=h+t,v=n*i+(n-1)*u,s=null,o=null,y;if(n===1||h+v<=l+a?s=new Common.App.CollabControls.d(0,0,2,4):(s=this.d(g,v,l,a),y=s.a-h,s.a=y),this.b)o=new Common.App.CollabControls.d(0,0,2,this.a?4:3);else{var p=this.e(f,e),c=Math.max(0,e.x),w=e.width,b=p,k=p+t;b+r<=c+w?o=new Common.App.CollabControls.d(0,0,2,this.a?3:4):r<=k-c&&(o=new Common.App.CollabControls.d(0,0,2,this.a?4:3));o||(o=this.c(b,k,r,c,w))}return new Common.App.CollabControls.d(s.a,o.d,s.c,o.b)},f:function(n){return Common.g.I(n)},e:function(n,t){return this.a?t.width-Common.g.H(n):Common.g.G(n)},d:function(n,t,i,r){var u=1,f=Math.max(i,n-t),o=n-i,e;return t>o&&(u=2,e=t<r,f=e?r-t:i),new Common.App.CollabControls.d(f,0,u,4)},c:function(n,t,i,r,u){var f,e,o=n-r,s=u-t;return s>=o?(e=t,f=4):(e=n,f=3),new Common.App.CollabControls.d(0,e,2,f)}};Common.App.CollabControls.d=function(n,t,i,r){this.a=n;this.d=t;this.c=i;this.b=r};Common.App.CollabControls.d.prototype={a:0,d:0,c:0,b:0};Common.App.CollabControls.k=function(n,t,i,r,u,f,e){this.b=n;this.f=t;this.e=i;this.g=r;this.h=u;this.c=f;this.d=e;this.a=document.createElement("div");this.a.className="prTouchTarget"};Common.App.CollabControls.k.prototype={b:null,f:null,d:!1,e:0,g:0,h:0,c:0,a:null,i:function(n,t){if(n!==3){if(n===5||!this.b||!this.b.length){this.a.parentNode&&this.a.parentNode.removeChild(this.a);return}var f=0,u=0,i=0,r=0;n===4?(i=this.h,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.c+"px",f=Common.N.b(this.b[0].l.style.top),u=Common.N.b(this.d?this.b[0].l.style.right:this.b[0].l.style.left)):(i=this.e,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.k()+r*2+"px",f=Common.N.b(this.b[this.b.length-1].l.style.top),u=this.j(this.b[this.b.length-1].l,i,t));Common.N.e(this.a,"border-radius",this.c+"px");this.a.style.top=f-r-i+"px";this.d?this.a.style.right=u-r+"px":this.a.style.left=u-r+"px";this.a.parentNode||this.f.insertBefore(this.a,this.f.firstChild)}},j:function(n,t,i){return this.d&&!i?Common.N.b(n.style.right):this.d||i?this.d&&i?-Common.N.b(n.style.left)-t:-Common.N.b(n.style.right)-t:Common.N.b(n.style.left)},k:function(){return!this.b||!this.b.length?0:this.e+Math.min(this.b.length-1,2)*this.g}};Common.App.CollabControls.h=function(){this.c={}};Common.App.CollabControls.h.prototype={b:function(n,t){var r=Common.App.CollabControls.c.toString(n),i;return typeof t=="number"?(i=this.c[r],i?Number.parseInvariant(i.toString()):0):this.c[r]},a:function(n,t){this.c[Common.App.CollabControls.c.toString(n)]=t},d:function(n,t){Common.App.CollabControls.c.toString(n)in this.c||(this.c[Common.App.CollabControls.c.toString(n)]=t)}};Common.App.CollabControls.i.registerClass("Common.App.CollabControls.i",Common.bc,Sys.IDisposable);Common.App.CollabControls.e.registerClass("Common.App.CollabControls.e",Sys.EventArgs);Common.App.CollabControls.f.registerClass("Common.App.CollabControls.f",Common.App.CollabControls.i,Common.App.CollabControls.l,Sys.IDisposable);Common.App.CollabControls.a.registerClass("Common.App.CollabControls.a",Common.App.CollabControls.i);Common.App.CollabControls.f.a=0;Common.App.CollabControls.b.a="https://www.w3.org/2000/svg";Common.App.CollabControls.b.e="prDancingDots";Common.App.CollabControls.b.d="prAnimateCircle";Common.App.CollabControls.b.f="0 0 {0} {1}";Common.App.CollabControls.b.b=40;Common.App.CollabControls.b.c=120;Common.App.CollabControls.a.h="prModernFlyout UIFont";Common.App.CollabControls.a.d="flyoutIdle";Common.App.CollabControls.a.b="flyoutExpanded";Common.App.CollabControls.a.a="flyoutCollapsed";Common.App.CollabControls.a.f="flyoutFromIdle";Common.App.CollabControls.a.e="flyoutFromExpanded";Common.App.CollabControls.a.c="flyoutFromCollapsed";Common.App.CollabControls.a.g="flyoutStacked";Common.App.CollabControls.a.j="flyoutFromStacked";Common.App.CollabControls.a.i="flyoutFadeOut";Common.App.CollabControls.a.k="cui-img-cont-float cui-img-20by20";Common.App.CollabControls.a.l="flyoutLtrDir";Common.App.CollabControls.a.m="flyoutRtlDir";Type.registerNamespace("Common.App.Presence");Common.App.Presence.a=function(n,t,i,r,u,f,e,o,s){this.p=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.q=new Common.bc;this.k=n;this.j=t;this.i=i;this.g=r;this.d=f;Common.App.Presence.a.a=u;this.l=e;this.f=o;this.m=s;$$sc.a.WAA(t,i).CW(this.n)};Common.App.Presence.a.prototype={a:null,e:!0,c:null,k:null,d:0,j:null,b:null,i:null,h:null,g:null,l:null,f:null,m:!1,s:function(){this.q.k("u",null,this)},u:function(){this.j.a()&&this.i.a()&&(this.b=this.j.a(),this.h=this.i.a(),this.b.f(this.o),this.c=new Common.Z(2,2,this.d,this.p,88,null,!1,0),Common.App.Presence.a.a.a(this.c))},v:function(n,t){(this.e||this.w(t.b))&&Common.App.Presence.a.a.d(this.c,0)},w:function(n){var f=n,i,e,t,r,u;for(i in f)if(e={key:i,value:f[i]},t=this.g.a(e),t&&t.a()&&(r=t.a().toLowerCase(),u=this.a[r]||this.a[r.toUpperCase()],u&&u.a===2))return!0;return!1},y:function(n){var f=this.b.q(),i,r,c,l,a,e,v,k,t,y,u,p,s,h;if(f){if(i=new Date,r=!1,this.e){this.a=f;this.e=!1;c=this.a;for(l in c)a={key:l,value:c[l]},e=a.value,e.b<i&&(i=e.b),e.a===2&&(r=!0,this.h.b(a.key));r&&this.s();Common.App.Presence.a.a.d(n,this.r(i));return}var o=new($$sc.v.$$(String)),w=!1,b=this.a;for(v in b)(k={key:v,value:b[v]},t=k.key,t in this.a&&this.k.a()!==t)&&(y=this.a[t],u=f[t],y&&u&&(p=y.a,s=u.a,p===2&&s===1?(o.b(t),Diag.a.a(38052609,392,50,t+" returned from away")):p===1&&s===2&&(r=!0,w=!0,this.h.b(t),Diag.a.a(38052610,392,50,t+" went away")),s===1&&u.b<i&&(i=u.b)));this.a=f;Common.App.Presence.a.a.d(n,this.r(i));(o.f.length>0||r)&&this.s();o.f.length>0&&!this.m?(h=this.t(o),this.x(h)):h=new($$sc.v.$$(String));(w||h.f.length>0)&&this.l(2052777571,2,null)}},x:function(n){var i,r,t;if(n.f.length)for(i=n.$$lge();i.$$mn();)r=i.$$cu(),t=this.f.b(String.format($a.fy,r),!1),t.a(5),t.f("CoAuth_AuthorStatus_16x16x32"),this.f.a(t)},t:function(n){var e=this.b.p(),i=new($$sc.v.$$(String)),f=e,r,t,u;for(r in f)t={key:r,value:f[r]},n.c(t.key)&&(u=this.g.a(t),u&&(i.b(u.d()),n.e(t.key)));return i.f.length||Diag.a.a(38052611,392,10,"There were no coauthor names found"),i},r:function(n){var t=new Date;return Math.max(n.getTime()+this.d-t.getTime(),0)}};Common.App.Presence.b=function(){this.b=updates};Common.App.Presence.b.prototype={b:0,a:function(n){return!!(this.b&n)},toString:function(){if(this.a(0))return"none";var n=new($$sc.v.$$(String));return this.a(1)&&n.b("user(s) joined"),this.a(2)&&n.b("user(s) disconnected"),this.a(4)&&n.b("user(s) updated"),n.g().join(", ")}};Common.App.Presence.a.registerClass("Common.App.Presence.a");Common.App.Presence.a.a=null;Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.g=function(){};RealtimePresenceUI.g.registerInterface("RealtimePresenceUI.g");RealtimePresenceUI.b=function(n,t,i,r){var u,f;this.A=Function.createDelegate(this,this.bg);this.l=Function.createDelegate(this,this.bh);this.i=new($$sc.D.$$(Number));this.c=n;this.j=t;i&&(u=this,i.CW(function(){u.g=i.a();u.g.b(u.l);u.k()}));r&&(f=this,r.CW(function(){f.f=r.a();f.f.a(f.l);f.k()}));this.B=new Common.cY(this.c.d,"Anonymous user","#cccccc",new Common.df(7),null,null,null,null,!1,!1,!1,0,null,0);this.n=!0;this.h=!0;this.q=!1;this.m=!1;this.d=RealtimePresenceUI.f.a(this.c.d,this.c.b,n.e)};RealtimePresenceUI.b.a=function(n,t){var i=n,r=t;return i.c().a(1)&&r.c().a(1)||!i.c().a(1)&&!r.c().a(1)?Common.d.bh(n.o,t.o):i.c().a(1)?-1:1};RealtimePresenceUI.b.prototype={B:null,n:!1,q:!1,m:!1,c:null,d:null,j:null,g:null,f:null,h:!1,T:function(){return Common.a.a?Common.a.a.a("ColorPresenceHashIsEnabled"):!1},F:function(){return Common.a.a?Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled"):!1},V:function(n,t,i,r,u,f){var e,o,s,h,c=this.W();this.d.a()?this.d.a()===1?(e=!0,o=this.c.a.a.a,s=this.c.a.a.b,h=this.d.b()[0].e()):(e=!0,o=this.c.a.h.a,s=this.c.a.h.b,h=""):(e=!1,o="",s="",h="");n.val=c[0];t.val=c.slice(1);i.val=e;r.val=o;u.val=s;f.val=h},W:function(){if(this.d.a()>=2)return[String.format($a.kq,this.d.a())];if(this.d.a()===1){var n=this.d.b()[0],t=this.c.b(n.a());return t&&t.a===2?[$a.kt,n.d()]:[n.g()?$a.ks:$a.kr,n.d()]}return[$a.ku]},be:function(n){return this.bf(n)},D:function(n,t,i){if(!t)return i&&Diag.a.a(4482393,325,50,"User does not have any presence data"),!1;if(!this.C(n,t))return i&&Diag.a.a(4482394,325,50,"User has presence data but app can't use it"),!1;var r=this.c.b(n);return r&&r.a===2?!1:!0},Z:function(n){return n.g()?$a.kw:$a.m},bf:function(n){if(!n.c().a(1))return this.Z(n);var t=n.g(),i=this.c.b(n.a()),r=this.c.c(n.a());if(!i)return $a.m;switch(i.a){case 1:return r?t?$a.kx:this.E(n.a(),t,r)||$a.m:$a.m;case 2:return $a.kv;default:return $a.m}},Y:function(n){return this.j.h()?this.j.b(n.b(),"O365",Common.a.i,0):undefined},ba:function(n){var t=this.c.b(n.a());return!t||t&&t.a===1?!0:!1},bd:function(n){return this.f?this.f.b(n.a()):n.c().a(4)},bb:function(n){var c=String.format("buttonPeoplesWellUser-{0}",n.a()),u=n.a(),l=this.be(n),f=n.d(),a=n.e(),t,i=(t=new Common.hY,t.Id=c,t.Command=this.c.a.e.toString(),t.LabelText="{0}",t.Image32by32=this.c.a.i.a,t.Image32by32Class=this.c.a.i.b,t.MenuItemId=u,t.CommandValueId=u,t.Alt=f,t.DisplayMode=this.H(),t.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",t.Description=l,t.ImageBackColor=a,t.IsAnonymous=n.f(),t.LabelTextUserGeneratedPlaceholderReplacements=RealtimePresenceUI.c.a([f]),t.Upn=n.b(),t),r,e,o,s,h;return Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&this.j&&(r=this.Y(n),e=this.ba(n),i.ImageUrl=r,i.ActiveStatus=e,o=n.h(),i.JoinTimeInMS=o,s=this.D(n.a(),this.c.c(n.a()),!1),h=this.bd(n),i.CanJump=s,i.ChatCapable=h,r===""&&Diag.a.a(40969413,302,50,"ImageURL collection failed")),i},X:function(){var n;return n=new Common.bU,n.Id="BasicChat",n.Command="2288458806",n.LabelText=$a.mm,n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",n},H:function(){return this.T()?"Initials":"Menu32"},bc:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t)u=r[t],f=this.bb(u),Array.add(i,f);return i},bj:function(n){if(!this.n)return!0;this.h||(n[CommandUI.Controls.d.Visible]=!0);var i,t,r,e,u,f,o,s,h,c,l,a;return this.V(o={val:i},s={val:t},h={val:r},c={val:e},l={val:u},a={val:f}),i=o.val,t=s.val,r=h.val,e=c.val,u=l.val,f=a.val,n[CommandUI.Controls.d.LabelText]=i,t&&t.length&&(n[CommandUI.Controls.d.LabelTextUserGeneratedPlaceholderReplacements]=t),n.ImageIsVisible=r,n[CommandUI.Controls.d.Image16by16Class]=u,n.ImageBackColor=f,this.n=!1,!0},bi:function(n){var e,r,o;if(this.d.a()<=0)return!1;var s=this.bn(this.d.b()),h=this.bc(s),i,u=(i=new Common.cC,i.Id="menuCoauthors",i.MaxWidth="220px",i.MenuSectionList=[],i),t,f=(t=new Common.cg,t.Id="msCoauthors",t.ControlsId="msCoauthorsControls",t.DisplayMode=this.H(),t.ControlList=h,t);return Common.a.a.a("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.j&&(f.Title=$a.kp,f.TitleId="menuCoauthorsTitle",f.Theme="Light"),Array.add(u.MenuSectionList,f),Common.a.a.a("DocChatIsEnabled")&&Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&Common.a.b()&&Common.a.b().a().f()&&(e=[],Array.add(e,this.X()),o=(r=new Common.cg,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=e,r),Array.add(u.MenuSectionList,o)),Common.a.b()&&Common.a.b().a().f()?n.MenuItems=u:n.PopulationXML=Common.A.f(u),!0},bo:function(n){var t,i;return(Diag.a.a(4482395,325,50,"PeoplesWell: Received user button click"),t=n.MenuItemId,!t)?!1:(i=this.c.c(t),!this.D(t,i,!0))?!1:(this.I(t,i),!0)},bk:function(){var n=this.U();this.d.c(n);this.h&&this.d.a()>=1&&(Diag.a.a(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.h=!1);this.n=!0},bh:function(){if(!this.m){var n=this;window.setTimeout(function(){n.k();n.m=!1},3e3);this.m=!0}},U:function(){var n=null,r;n||(n=this.G()||[]);for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.bm(r);return n},bm:function(n){n.a()||n.j(Common.w.a().a);n.d()||n.m("Anonymous user");n.c()||n.i(new Common.df(0));n.e()||n.k("#cccccc");n.h()||n.l(0)},bn:function(n){var t=[];return Array.addRange(t,n),t.sort(RealtimePresenceUI.b.a),t},bl:function(){Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.a.c().a(691867605,2147483648,this.A);this.J();this.q=!0;this.k()},bg:function(n,t,i,r,u){return this.i.d(u.RenderTime),32},a:function(){return this.i.a},k:function(){if(this.q||(this.i.d((new Date).getTime()),Diag.a.a(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),!this.F())){if(this.bk(),this.F()&&this.h){Common.ci.d("ribbon","coauthorGallery",!1);return}Common.ci.c("ribbon","coauthorGallery",!1);Common.ci.a("ribbon","coauthorGallery",!1);this.x()}},dispose:function(){this.g&&(this.g.c(this.l),this.g=null);this.f&&(this.f.c(this.l),this.f=null)}};RealtimePresenceUI.a=function(n,t,i,r,u){var f,e;this.a=n;this.d=t;this.e=u;f=this;this.c=i||function(){return null};e=this;this.b=r||function(){return null}};RealtimePresenceUI.a.a=function(n,t,i,r,u){return new RealtimePresenceUI.a(n,t,i,r,u)};RealtimePresenceUI.a.prototype={a:null,d:null,c:null,b:null,e:!1};RealtimePresenceUI.c=function(){};RealtimePresenceUI.c.a=function(n){var t,i;if(!n||!n.length)return null;t=new Sys.StringBuilder("STRARRY@");for(var u=n,f=u.length,r=0;r<f;++r)i=u[r],t.append(i?i.length:0),t.append(","),t.append(i),t.append(",");return t.toString().slice(0,-1)};RealtimePresenceUI.h=function(n){this.d=new($$sc.w.$$(Array));this.e=n};RealtimePresenceUI.h.prototype={e:null,f:null,c:function(n){var i;this.k();this.l(n);for(var r=n,u=r.length,t=0;t<u;++t)i=r[t],i.a()!==this.e&&this.h(i)},b:function(){for(var n=new Array(0),t=this.d.k().$$ge(),i,r;t.$$mn();)i=t.$$cu(),r=this.j(i),Array.add(n,r);return n},a:function(){return this.d.e},i:function(n,t){n=n.toUpperCase();var i,r,u;(u=this.d.f(n,r={val:i},null),i=r.val,u)||(i=new Array(0),this.d.a(n,i));Array.add(i,t)},k:function(){this.d=new($$sc.w.$$(Array))},l:function(n){for(var i,r=n,u=r.length,t=0;t<u;++t)if(i=r[t],i.a()===this.e){this.f=i;return}}};RealtimePresenceUI.f=function(){};RealtimePresenceUI.f.a=function(n,t,i){return i?new RealtimePresenceUI.d(n,t):new RealtimePresenceUI.e(n)};RealtimePresenceUI.d=function(n,t){RealtimePresenceUI.d.initializeBase(this,[n]);this.g=t};RealtimePresenceUI.d.prototype={g:null,h:function(n){if(n.f()||!n.b()){this.i(n.a(),n);return}this.f&&$$sc.d.a().a(this.f.b(),n.b())||this.i(n.b(),n)},j:function(n){for(var r,t,u=new Date(0),f=n.length>0?n[0]:null,e=n,o=e.length,i=0;i<o;++i)(r=e[i],t=this.g(r.n),t)&&u.getTime()<t.b.getTime()&&(u=t.b,f=r);return f}};RealtimePresenceUI.e=function(n){RealtimePresenceUI.e.initializeBase(this,[n])};RealtimePresenceUI.e.prototype={h:function(n){this.i(n.a(),n)},j:function(n){return n[0]}};RealtimePresenceUI.b.registerClass("RealtimePresenceUI.b",null,Common.el,Sys.IDisposable);RealtimePresenceUI.h.registerClass("RealtimePresenceUI.h");RealtimePresenceUI.d.registerClass("RealtimePresenceUI.d",RealtimePresenceUI.h);RealtimePresenceUI.e.registerClass("RealtimePresenceUI.e",RealtimePresenceUI.h);Type.registerNamespace("_Ewa");_Ewa.Vh=function(n){this.o=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.y);this.j=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.x);_Ewa.Vh.initializeBase(this,[!1]);this.e=n;Diag.a.b(40461393,0,!!this.e.b(),"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");this.e.D(this.l);this.e.b().E(this.k);this.e.b().cd(this.j);this.e.b().q(this.m);this.e.b().t()&&this.n(this,Sys.EventArgs.Empty)};_Ewa.Vh.prototype={f:null,h:null,g:!1,i:!1,e:null,a:function(n){this.eo("SVCU",n)},b:function(n){this.ep("SVCU",n)},dispose:function(){this.f=null;this.h=null;this.e&&this.e.J(this.l);this.e.b()&&(this.e.b().B(this.k),this.e.b().cG(this.j),this.e.b().s(this.m));this.e=null;_Ewa.bW.prototype.dispose.call(this)},d:function(n){return this.g?null:this.q(n,this.h,"ConvertPresencePublicToPrivate")},c:function(n){return this.g?null:this.q(n,this.f,"ConvertPresencePrivateToPublic")},z:function(n){if(!n){Diag.a.a(40993282,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null");return}this.t(n);this.f=n;this.h=this.r(this.f)},y:function(){var t=this.e.b().m(),n,u,e;if(t&&t.SheetChanges)for(var o=t.SheetChanges,c=o.length,i=0;i<c;++i)if(n=o[i],n.Type===2){if(this.f)for(var s=this.f,l=s.length,r=0;r<l;++r)u=s[r],u.Range.SheetName===n.Name&&(u.Range.SheetName=n.NewName);if(this.h)for(var h=this.h,a=h.length,f=0;f<a;++f)e=h[f],e.Range.SheetName===n.Name&&(e.Range.SheetName=n.NewName)}},w:function(){Diag.a.a(50657436,0,50,"NamedSheetViewConversionManager.OnGridLoaded");this.i=!1;this.n(this,Sys.EventArgs.Empty)},x:function(){Diag.a.a(50657437,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");this.i=!0},n:function(){if(Diag.a.a(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",this.e.b().bH()),!this.e.j()||!this.e.b().a()||this.e.b().ba()||this.i||this.e.b().bH()===-2){Diag.a.a(50467170,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",this.e.j(),this.e.b().a(),this.e.b().ba(),this.i);return}this.f=null;this.h=null;var n=this.e.c().a().b(!1);_Ewa.WZ.a(this.e.c().a(),this.p,this.o,null,n,null)},v:function(n){var t,r,i;if(_Ewa.j.e(n.Errors)){this.g=!0;t=[-1100324317,-1857233882];_Ewa.j.d(n.Errors,t)&&Diag.a.a(40993283,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",_Ewa.j.a(n.Errors,","));r=_Ewa.j.f(n.Errors,t,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");this.e.b().p(r);return}this.g=!1;i=n.Result;this.e.b().cL(i.ConversionVersion);this.z(i.NamedSheetViewConversionEntries);this.A()},u:function(n){this.g=!0;var t=n.b,i=_Ewa.W.a(t);Diag.a.a(40993284,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",_Ewa.j.a(i,","))},A:function(){Diag.a.a(40461394,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");this.em("SVCU",null,null)},q:function(n,t,i){var r,u,f,e,h;if(!t||!t.length)return Diag.a.a(40993285,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",i,t?"empty":"null"),n;for(var c=n,a=c.length,o=0;o<a;++o){r=c[o];for(var l=t,v=l.length,s=0;s<v;++s)if((u=l[s],u.IsRow)&&_Ewa.gg.a(u.Range,r)&&(!(r.FirstRow<=u.Range.FirstRow)||!(r.LastRow>=u.Range.LastRow)))if(f={},f.SheetName=r.SheetName,f.FirstRow=f.LastRow=r.FirstRow,f.FirstColumn=f.LastColumn=r.FirstColumn,_Ewa.gg.a(u.Range,f)){if(e=-1,h=-1,e=r.FirstRow-u.Range.FirstRow,e<0||e>=u.ConversionMap.length){Diag.a.a(40993286,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",e,u.ConversionMap.length);continue}else h=u.ConversionMap[e]-e;r.FirstRow+=h;r.LastRow=r.FirstRow;r.LastColumn=Math.min(r.LastColumn,u.Range.LastColumn)}else r.FirstRow<u.Range.FirstRow&&r.LastRow>=u.Range.FirstRow?r.LastRow=u.Range.FirstRow-1:r.LastColumn>=u.Range.FirstColumn&&(r.LastColumn=u.Range.FirstColumn-1);(r.FirstRow<0||r.FirstRow>1048575)&&(r.FirstRow=Math.max(Math.min(r.FirstRow,1048575),0));(r.LastRow<0||r.LastRow>1048575)&&(r.LastRow=Math.max(Math.min(r.LastRow,1048575),0));(r.FirstColumn<0||r.FirstColumn>16383)&&(r.FirstColumn=Math.max(Math.min(r.FirstColumn,16383),0));(r.LastColumn<0||r.LastColumn>16383)&&(r.LastColumn=Math.max(Math.min(r.LastColumn,16383),0))}return n},r:function(n){var u,t,i,r;if(!n||!n.length)return Diag.a.a(40993287,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.f?"empty":"null"),n;for(u=new Array(n.length),t=0;t<n.length;++t){for(i=new _Ewa.Ey,i.Range=n[t].Range,i.IsRow=n[t].IsRow,i.ConversionMap=new Array(n[t].ConversionMap.length),i.IsRow||(this.g=!0,Diag.a.a(41185634,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI.")),r=0;r<n[t].ConversionMap.length;++r)i.ConversionMap[n[t].ConversionMap[r]]=r;u[n.length-t-1]=i}return u},t:function(n){var t,r;if(n&&n.length)for(var u=n,f=u.length,i=0;i<f;++i)t=u[i],this.s(t),r=t.IsRow?t.Range.LastRow-t.Range.FirstRow+1:t.Range.LastColumn-t.Range.FirstColumn+1,t.ConversionMap.length!==r&&(Diag.a.b(41435473,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",r,t.ConversionMap.length),this.g=!0)},s:function(n){var t=n.ConversionMap,r,i,f,e,u;if(t&&t.length){if(t[0]<0){Diag.a.b(41435474,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number");this.g=!0;return}for(r=[],i=0;i<t.length;++i)if(t[i]<0)for(f=t[i-1],e=t[i]*-1,u=1;u<=e;++u)Array.add(r,f+u);else Array.add(r,t[i]);n.ConversionMap=r}}};_Ewa.bpv=function(){};_Ewa.bpv.registerInterface("_Ewa.bpv");_Ewa.bpw=function(){};_Ewa.bpw.registerInterface("_Ewa.bpw");_Ewa.WU=function(n,t,i){this.a(null);this.d=n;this.g=t;this.h=i;this.e=new _Ewa.sS(_Ewa.c.a(this.g),this.d.User.UserID,this.d.User.UserName,this.d.UserColor,null,i,this.g,this.d.IsAnonymous)};_Ewa.WU.prototype={g:null,e:null,d:null,h:null,f:null,a:function(n){return this.f=n,this.f&&this.h.S(this.f.co()),n},i:null,dispose:function(){this.j();System.a.a(this.e);this.a(null);this.d=null;this.g=null;this.i=null},l:function(n){this.e.N(n.e)},j:function(){this.f&&this.d&&this.d.User&&(this.f.bv(!1,this.d.User.UserID,null),this.e.o(!0))},b:function(){_Ewa.eH.b&&this.f&&this.d&&this.d.User&&(this.f.bv(!0,this.d.User.UserID,this.d.UserColor),this.e.v())},k:function(n){_Ewa.eH.a&&(this.e.t(n),this.e.e(n,!0))},c:function(n,t){this.e.O(null,t?37:36,n)}};_Ewa.sR=function(){_Ewa.sR.initializeBase(this,[!1])};_Ewa.sR.a=function(n,t){var i=n.c.d();System.a.b(n.b());System.a.b([n.c]);n.c=null;n.c=new _Ewa.Bk(t);n.n([]);n.z(t);n.o(i)};_Ewa.sR.prototype={c:null,k:null,b:function(){return this.k},n:function(n){return this.k=n,n},l:null,g:function(){return this.l},z:function(n){return this.l=n,n},a:function(){return this.c.d()},o:function(n){return this.c.e(n),n},x:function(){},h:function(){return null},m:function(){return null},p:function(){},q:function(){},B:function(){},A:function(){},y:function(){}};_Ewa.WV=function(n){_Ewa.WV.initializeBase(this);this.m=n;this.l()};_Ewa.WV.prototype={m:null,i:null,a:function(){this.k(this.i||(this.i=new _Ewa.Vh(this.m)))}};_Ewa.gI=function(n,t,i){var r,e,u,f;for(this.q=Function.createDelegate(this,this.v),this.n=Function.createDelegate(this,this.u),_Ewa.gI.initializeBase(this,[!1]),this.l=n,this.t=n.d(),this.o=!1,this.k=new _Ewa.y(!0),r=0;r<4;r++)e=this.l.g().A(i,_Ewa.gI.a()[r])||_Ewa.gI.a()[r]===1,e&&(u=t.a(document.createElement("div"),!1),f=n.n(_Ewa.gI.a()[r]).l(),f.insertBefore(u.a(),f.firstChild),this.k.c(Enum.toString(_Ewa.qo,_Ewa.gI.a()[r]),u))};_Ewa.gI.a=function(){return _Ewa.gI.b||(_Ewa.gI.b=[1,3,2,4])};_Ewa.gI.prototype={l:null,t:!1,m:null,o:!1,s:null,p:!1,k:null,a:function(){return null},c:function(){var n=_Ewa.y.a(this.k.b,Enum.toString(_Ewa.qo,_Ewa.gI.a()[0]),null);return n?n.c():null},dispose:function(){var n,t,i;if(this.k.a.length>0){this.e();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.dispose()}this.l=null;this.k.f();_Ewa.bW.prototype.dispose.call(this)},i:function(){var t=this.k.b,n,i;for(n in t)i={key:n,value:t[n]},i.value.i()},h:function(){var n,t,i;this.r();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.h()},e:function(){var n,t,i;this.w();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.e()},b:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.b(n)},f:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},g:function(n,t){var r=this.k.b,i,u;for(i in r)u={key:i,value:r[i]},u.value.g(n,t)},d:function(n){var t,i,r;this.o!==n&&(this.o=n,t=_Ewa.y.a(this.k.b,Enum.toString(_Ewa.qo,_Ewa.gI.a()[0]),null),this.m&&t&&(i=_Ewa.b.G(t.a())/2,r=this.o?this.m.x+14+i:this.m.x-14-i,this.j(r,this.m.y)))},j:function(n,t){var r=this.k.b;for(var u in r){var f={key:u,value:r[u]},o=Enum.parse(_Ewa.qo,f.key),e=this.l.n(o),i=_Ewa.Bg.a(e,new Sys.UI.Point(n,t),!1);this.m=new Sys.UI.Point(n,t);i.x<0&&(i.x+=e.l().scrollLeft);_Ewa.b.t(f.value.a(),i.x,i.y,!1,this.t)}},u:function(){this.r()},v:function(){this.r()},r:function(){this.m&&(this.j(this.m.x,this.m.y),this.p||(this.p=!0,this.l.b().i(this.n),this.l.b().f(this.n),this.l.j().d(this.q)))},w:function(){this.p&&(this.l.b().k(this.n),this.l.b().e(this.n),this.l.j().c(this.q))}};_Ewa.sS=function(n,t,i,r,u,f,e,o){this.I=Function.createDelegate(this,this.R);this.J=Function.createDelegate(this,this.S);this.K=Function.createDelegate(this,this.T);this.H=Function.createDelegate(this,this.Q);this.w={};_Ewa.sS.initializeBase(this,[!1]);o=!!(o|i===_Ewa.ClientStringManager.a().c(84));this.G=new Common.cY(t,i,r,new Common.df(0),null,null,null,null,o,!1,!1,0,null,0);this.D=n;this.y=t;this.F=u;this.B=f;this.M=e};_Ewa.sS.a=function(n,t){return n.toString()+t.toString()};_Ewa.sS.prototype={C:null,F:null,L:0,D:null,B:null,z:null,E:null,M:null,j:function(n){this.eo("hidePresenceTooltip",n)},p:function(n){this.ep("hidePresenceTooltip",n)},m:function(n){this.eo("showPresenceTooltip",n)},r:function(n){this.ep("showPresenceTooltip",n)},l:function(n){this.eo("showFullPresenceTooltip",n)},q:function(n){this.ep("showFullPresenceTooltip",n)},k:function(n){this.eo("presenceChanged",n)},s:function(n){this.ep("presenceChanged",n)},y:null,a:function(){return this.y},G:null,c:function(){return this.G},x:0,b:function(){return this.x},i:function(){return this.C},h:function(){return this.C||this.E?_Ewa.Bg.a(this.D.n(this.x),this.A(this.x).h(),!0):null},g:function(){return this.A(this.x).g()},t:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.t(n);return n},dispose:function(){var t,i,r,n;this.em("hidePresenceTooltip",null,null);this.em("presenceChanged",null,null);this.B&&this.B.O(this.y);t=this.w;for(i in t)r={key:i,value:t[i]},n=r.value,n.p(this.H),n.r(this.K),n.q(this.J),n.s(this.I),n.dispose();this.w=null;this.D=null;this.F=null;this.C=null;this.B=null;_Ewa.bW.prototype.dispose.call(this)},O:function(n,t,i){n?(this.C=_Ewa.h.b(n),this.x=this.D.g().e(this.C.O())):i?(this.E=i,this.x=i.e().A()):this.x=1;this.L=t;this.A(this.x);this.u(n,i)},u:function(n,t){var r=this.w,i,u;for(i in r)u={key:i,value:r[i]},u.value.u(n,t)},o:function(n){var t,i,r;this.A(this.x).o(n);t=this.w;for(i in t)r={key:i,value:t[i]},r.value.o(!1)},N:function(n){var r=this.w,t,u,i;for(t in r)u={key:t,value:r[t]},i=u.value,i.n(n.A(i.b()))},n:function(n){this.A(n.b()).n(n)},d:function(){var n=this.A(this.x).d(),i=this.w,t,r;for(t in i)r={key:t,value:i[t]},n=!!(n|r.value.d());return n},e:function(n,t){var i,r,u;this.B.t(this);this.A(this.x).e(n,t);i=this.w;for(r in i)u={key:r,value:i[r]},u.value.e(n,!1)},f:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},v:function(){var t=this.w,n,i;for(n in t)i={key:n,value:t[n]},i.value.v();this.B.t(this)},A:function(n){return this.P(n,this.L)},P:function(n,t){var u=this.F?this.F.f(t,n,0).b:this.E?this.E.C():null,r=_Ewa.sS.a(t,n),i=_Ewa.y.a(this.w,r,null);return i||(i=new _Ewa.Xb(u,this.D,this.G,n,this.M),this.w[r]=i,i.j(this.H),i.m(this.K),i.l(this.J),i.k(this.I)),i},Q:function(n){this.z&&this.z!==n||(this.z=null,this.o(!1));this.em("hidePresenceTooltip",null,null)},T:function(n){this.z&&this.z!==n||(this.z=null,this.e(!0,!1));this.em("showPresenceTooltip",null,null)},S:function(n){this.z||this.em("showFullPresenceTooltip",null,null);this.z=n},R:function(){this.o(!1);this.em("presenceChanged",null,null)}};_Ewa.Bh=function(n){this.f=Function.createDelegate(this,this.h);this.e=new Common.bc;this.d=n;this.d.b().Q(this.f)};_Ewa.Bh.prototype={d:null,g:!1,dispose:function(){this.g||(this.d&&this.d.b()&&this.d.b().T(this.f),System.a.b([this.e]),this.e=null,this.d=null,this.g=!0)},b:function(n){this.e.m("UU",n)},c:function(n){this.e.n("UU",n)},a:function(){for(var n,u,t=[],r=this.d.b().u(),f=r.length,i=0;i<f;++i)n=r[i],u=new Common.cY(n.User.UserID,n.User.UserName,n.UserColor,new Common.df(1),null,n.UserEmail,null,null,!1,!1,!1,n.JoinCoauthTime,null,0),Array.add(t,u);return Diag.a.a(42481440,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",t.length),t},h:function(){Diag.a.a(42481442,0,50,"PeopleInfoProvider.OnUserListUpdated fired");this.e.k("UU",this,null)}};_Ewa.WW=function(){};_Ewa.WW.prototype={a:function(n){var f=n.key,i=n.value,r,t,u;return i?(r=i.SupportsChat?4:0,u=(t=new Common.cY,t.n=f,t.u=i.ChatThreadId,t.t=i.ChatThreadDiscoveryUri,t.v=i.InChat,t.s=i.Cid,t.q=new Common.df(r),t),u):null}};_Ewa.sT=function(){_Ewa.sT.initializeBase(this);this.l()};_Ewa.sT.a=function(n){n.a().b(_Ewa.bnd.$$(Common.eS),159,new _Ewa.sT)};_Ewa.sT.prototype={i:null,a:function(){this.k(this.i||(this.i=new _Ewa.WW))}};_Ewa.gh=function(n,t,i){_Ewa.gh.initializeBase(this,[t,_Ewa.c.a(t),!0,!1,n.User.UserID]);_Ewa.gh.a||(_Ewa.gh.a={});this.A=n;this.X=t;this.u=new _Ewa.sS(this.t,this.A.User.UserID,this.A.User.UserName,this.A.UserColor,this,i,this.X,this.A.IsAnonymous)};_Ewa.gh.b=function(n,t,i){if(i){if(t===n.firstChild)return;n.removeChild(t);n.insertBefore(t,n.firstChild)}else{if(t===n.lastChild)return;n.removeChild(t);n.appendChild(t)}};_Ewa.gh.prototype={A:null,V:36,C:!1,J:!1,X:null,u:null,dispose:function(){var t,i,r,n;System.a.a(this.u);_Ewa.hq.prototype.dispose.call(this);t=_Ewa.gh.a;for(i in t)r={key:i,value:t[i]},n=r.value,n&&!n.children.length&&(_Ewa.b.g(n),_Ewa.gh.a[r.key]=null)},W:function(n){this.u.N(n.u)},bo:function(n){_Ewa.eH.a&&(this.J||(this.u.t(n),this.u.e(n,!0)),this.C=n&&this.J)},Z:function(n,t){this.u.O(n,t?37:36,null);this.C=!1},Y:function(n){_Ewa.eH.b&&(this.u.e(!0,!0),this.V=n,this.d([n],null,null))},bn:function(n){this.bJ();this.a(n)},bf:function(n,t,i){var u,e,r,f;i.className="ewr-cell-presence-highlight-all";i.style.borderColor=this.A.UserColor;u=document.createElement("div");n!==36&&n!==37&&(u.style.backgroundColor=this.A.UserColor);i.appendChild(u);e=["ewr-cell-presence-highlight-fill","ewr-cell-presence-highlight-edit"];u.className=e[n-36];r=_Ewa.y.a(_Ewa.gh.a,t.toString(),null);r||(f=this.t.n(t).l(),r=document.createElement("div"),f.insertBefore(r,f.firstChild),_Ewa.gh.a[t.toString()]=r);r.appendChild(i)},bg:function(){},bj:function(n,t,i,r){var f=this.bI(r,n,t),u,e,o;_Ewa.dU.a(i,this.t.d(),f.a.a+"px");i.width=f.c()+"px";i.top=f.a.b+"px";i.height=f.d()+"px";u=t.b;e=u.parentNode;n===37?_Ewa.gh.b(e,u,!1):n===36&&(o=this.f(37,1,0),r.g(o.l)?_Ewa.gh.b(e,u,!1):_Ewa.gh.b(e,u,!0));this.bK(n)},bl:function(){return!1},bI:function(n,t,i){var r=n.a.b+this.F(i,!1),u=n.a.a+this.F(i,!0)+_Ewa.bf.i(i.b.parentNode.parentNode,this.t.d()),f=n.c(),e=n.d()+1;return u<1&&u>=-1&&t===36&&(f-=1-u,u=1),r<1&&r>=-1&&t===36&&(e-=1-r,r=1),f=Math.max(0,f-1),e=Math.max(0,e-2),new _Ewa.bb(u,r,f,e)},bK:function(n){this.u.v();this.V=n;this.J=!1;this.C&&this.bo(!0);this.C=!1},bJ:function(){this.J||(this.u.o(!0),this.C=!1)}};_Ewa.WY=function(n){this.u=Function.createDelegate(this,this.E);this.i=n;Common.ba.b()&&(this.o=window.performance.timing.navigationStart);this.o||Diag.a.a(555038465,0,15,"Navigation start time is zero");this.i.b().g(this.u)};_Ewa.WY.prototype={i:null,C:!1,B:!1,s:!1,x:!1,y:!1,A:!1,q:!1,z:!1,t:0,m:0,l:0,p:0,r:0,w:!1,k:0,o:0,n:!1,h:function(n){this.C||(this.t=n,this.C=!0)},g:function(n,t){this.B||(this.m=t,this.w=n,this.B=!0)},f:function(n){this.s||(this.l=n,this.s=!0)},d:function(n){!this.q&&this.s&&(this.r=n,this.q=!0)},a:function(n){this.x||(this.p=n,this.x=!0)},b:function(n){if(!this.y&&this.j()&&!this.n){this.y=!0;var t=this.v();t.RtcIntializeToPeopleWellServiceCreate=this.p-this.m;t.PeopleWellServiceCreateToPresenceGalleryRender=n-this.p;t.PresenceGalleryRenderTotalTime=n-this.j();_Ewa.X.a(this.i).a(_Ewa.u.F,t,null,!0)}},e:function(n){if(!this.A&&this.j()&&!this.n){this.A=!0;var t=this.v();t.RtcIntializeToRtcConnect=this.l-this.m;t.RtcConnectToPresenceSent=n-this.l;t.PresenceSentTotalTime=n-this.j();_Ewa.X.a(this.i).a(_Ewa.u.H,t,null,!0)}},c:function(n){if(!this.z&&this.q&&this.j()&&!this.n){this.z=!0;var t=this.v();t.RtcIntializeToRtcConnect=this.l-this.m;t.RtcConnectToPresenceRenderInitiate=this.r-this.l;t.PresenceRenderInitiateToPresenceRenderFinish=n-this.r;t.PresenceRenderTotalTime=n-this.j();_Ewa.X.a(this.i).a(_Ewa.u.G,t,null,!0)}},dispose:function(){this.i=null},v:function(){var n={};return n.CoAuthorCountsOnBoot=this.i.b().u().length,n.RtcConnectedLaterInSession=this.w,n.BrowserVisibilityChanged=this.D(),n.AppInteractiveAbsTime=this.j(),n.NavigationStartTime=this.o,n.AppInteractiveToRtcSliceLoad=this.t-this.j(),n.RtcSliceLoadToRtcInitialize=this.m-this.t,n},j:function(){return this.k?this.k:(Common.bm.a().c("AppInitStatus_interactivityReady")&&(this.k=Common.bm.a().b("AppInitStatus_interactivityReady")),this.k||Diag.a.a(555038464,0,15,"App interactive time is zero"),this.k)},E:function(){this.n=!0;this.i.b().j(this.u)},D:function(){if(Common.ba.b()&&Common.bm.a().c("UserActions")){var n=Common.bm.a().b("UserActions");return n.VisiToggled>0}return!1}};_Ewa.Bi=function(n){_Ewa.Bi.initializeBase(this);this.i=n;this.l()};_Ewa.Bi.a=function(n){n.a().b(_Ewa.bnd.$$(_Ewa.fI),436,new _Ewa.Bi(n))};_Ewa.Bi.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.fI,435,!1,null)||this.i.a().b(_Ewa.fI,435,new _Ewa.WY(this.i)))}};_Ewa.Bj=function(n){this.v=Function.createDelegate(this,this.Q);this.u=Function.createDelegate(this,this.E);this.r=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.L);this.p=Function.createDelegate(this,this.I);this.o=Function.createDelegate(this,this.H);this.h=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.J);this.k="ewaboot_doughboywhite20";this.f=20;this.a=_Ewa.c.a(n);this.c=n;this.g={};this.b={};this.d={};this.e={};this.c.d()&&this.c.d().c(this.q);this.x()};_Ewa.Bj.a=function(n,t,i){return n.x.toString()+"-"+n.y.toString()+"-"+t.toString()+"-"+i.a.toString()+"-"+i.b.toString()};_Ewa.Bj.prototype={f:16,g:null,d:null,b:null,e:null,i:!1,k:null,a:null,c:null,l:null,j:null,dispose:function(){this.N();this.w();this.c&&this.c.d()&&this.c.d().d(this.q);this.a=null},N:function(){this.i&&(this.a.b().k(this.h),this.a.b().e(this.h),this.a.j().c(this.o),this.i=!1)},O:function(n){var t=this.d[n],i=this.b[n];t&&this.A(t);i&&this.m(i,t.c().n,this.c,t.b(),t.a());delete this.b[n];delete this.d[n];delete this.e[n]},t:function(n){var t=n.a(),i=this.d[t];i||(this.F(n),this.d[t]=n)},R:function(n){var u=n.g(),i=n.a(),t=this.y(n.h(),n.b(),n.i()),r=this.b[i];t&&t!==r&&(n.f(t),this.b[i]=t,this.d[i]=n,this.e[i]&&t.d(this.e[i]));r!==t&&r&&this.m(r,n.c().n,this.c,n.b(),n.a());!this.i&&this.a&&(this.a.b().i(this.h),this.a.b().f(this.h),this.a.j().d(this.o),this.i=!0)},m:function(n,t,i,r,u){var e,f,o;n.f(t);_Ewa.a.a("OfficeVSO:3663630_ModernPresenceUxPerf")&&(e=this.b[u],e===n&&delete this.b[u]);n.c()&&n.c().length||(f=n.s,f&&delete this.g[f],_Ewa.a.a("OfficeVSO:3663630_ModernPresenceUxPerf")||(o=this.b[u],o===n&&delete this.b[u]),n.dispose())},A:function(n){n&&(n.p(this.p),n.r(this.s),n.q(this.r),n.f(null))},F:function(n){n.j(this.p);n.m(this.s);n.l(this.r)},I:function(n){var t=n,i=this.b[t.a()];i&&this.m(i,t.c().n,this.c,t.b(),t.a())},L:function(n){this.B(!1,n)},K:function(n){this.B(!0,n)},B:function(n,t){var i,r;_Ewa.eH.a&&(t.g()||this.t(t),this.R(t),i=this.b[t.a()],i&&(r=t.i(),i.b(t.c()),t.d()?n?i.h():i.i():i.e()))},y:function(n,t,i){var u,e,f,r;return n?(u=this.D(n,t),e=this.a.n(t).z(),f=_Ewa.Bj.a(u,t,e).toString(),r=_Ewa.y.a(this.g,f,null),r||(r=new _Ewa.gI(this.a,this.l,i),r.j(u.x,u.y),r.s=f,this.g[f]=r),r):null},D:function(n,t){var f=this.a.n(t).v(),i=this.a.n(t).z(),r=_Ewa.ge.a(t,f.a),e=Math.max(i.a,n.x-this.f/2-2),u;return e=Math.min(Math.max(r.a+i.a,e),r.a+i.a+f.c()-this.f),u=Math.max(i.b,n.y-this.f/2+1),u=Math.min(Math.max(r.b+i.b,u),r.b+i.b+f.d()-this.f),new Sys.UI.Point(e,u)},w:function(){var r=this.d,n,u,t,i,f;for(n in r)u={key:n,value:r[n]},this.A(u.value);t=this.g;for(i in t)f={key:i,value:t[i]},f.value.dispose();this.b={};this.d={};this.g={};this.e={};System.a.a(this.j);this.j=null},G:function(){this.C()},H:function(){this.C()},J:function(){this.x();this.w()},E:function(n){for(var i=_Ewa.b.l(n.a()),f=new _Ewa.bb(i.x,i.y,i.width,i.height),u=_Ewa.gI.a(),e=u.length,r=0;r<e;++r){var o=u[r],s=this.a.n(o),t=_Ewa.b.h(s.l()),h=new _Ewa.bb(t.x,t.y,t.width,t.height);if(h.i(f))return t}return null},x:function(){var n=new Common.App.CollabControls.h;n.a(0,"ewaboot_presenceheadswhite");n.a(1,this.k);n.a(12,49);n.a(6,this.f);this.a&&(n.a(4,_Ewa.v.a(3)),n.a(5,_Ewa.v.a(3)),n.a(8,this.a.d()));n.a(18,!0);this.l=new Common.App.CollabControls.g(n);n.a(16,this.u)},P:function(n,t){var i=new Common.App.CollabControls.h;i.a(0,n?"ewaboot_presenceheadswhite":t);i.a(1,n===1?t:this.k);i.a(12,n===12?Number.parseInvariant(t.toString()):49);i.a(6,n===6?t:this.f);this.a&&(i.a(4,n===4?t:_Ewa.v.a(3)),i.a(5,n===5?t:_Ewa.v.a(3)),i.a(8,n===8?t:this.a.d()));this.l=new Common.App.CollabControls.g(i)},S:function(n){this.P(12,n)},C:function(){_Ewa.eH.a&&(this.j=_Ewa.cR.a(this.v,100,_Ewa.o.cf,this.j))},Q:function(){var u=this.d,r,f,n;for(r in u)if(f={key:r,value:u[r]},n=f.value,n){var e=n.d(),i=this.b[n.a()],t=e?this.y(n.h(),n.b(),n.i()):null;if(t!==i){if(i&&this.m(i,n.c().n,this.c,n.b(),n.a()),!_Ewa.eH.a)return;t&&e&&(t.b(n.c()),this.b[n.a()]=t,n.f(t),this.z(t,n))}else this.z(i,n)}},z:function(n,t){_Ewa.eH.a&&(this.e[t.a()]&&n.d(this.e[t.a()]),t.d()?t.e(!0,!0):t.e(!1,!0))},n:function(n,t){this.e[n]=t;var i=this.b[n];i&&i.d(t)},M:function(n,t){var i=this.b[n];i&&i.g(n,t)}};_Ewa.pD=function(n,t,i,r,u){this.H=Function.createDelegate(this,this.br);this.J=Function.createDelegate(this,this.bt);this.I=Function.createDelegate(this,this.bs);this.G=Function.createDelegate(this,this.bq);this.K=Function.createDelegate(this,this.be);this.T=Function.createDelegate(this,this.bo);this.M=Function.createDelegate(this,this.bv);this.N=Function.createDelegate(this,this.bz);this.F=Function.createDelegate(this,this.bp);this.L=Function.createDelegate(this,this.bu);this.k={};_Ewa.pD.initializeBase(this,[!1]);this.w={};this.x={};this.o={};this.n={};this.j=n;this.y=r;this.s=t;this.l=i;_Ewa.eH.b=!0;_Ewa.eH.a=!0;this.bl();this.p=new _Ewa.Bj(n);this.j.d()&&this.j.d().c(this.L);this.s.b(this.F);n.c()&&this.j.c().j(this.N);this.m=[];this.s.a();n.a().b(_Ewa.lL,25,this);this.q=!1;this.j.D(this.M);this.t=_Ewa.A.a().b(this.T,this.Q/2,_Ewa.o.cg,!0,!1);this.z=u};_Ewa.pD.a=function(n,t,i,r){var u;if(!r||!r.a()||!r.a().Object)return!1;for(var e=r.a().Object,o=e.length,f=0;f<o;++f)if(u=e[f],n&&u&&u.ObjectId&&!u.ObjectId.localeCompare(n))return Array.add(u.ObjectPresenceType===1?i:t,r.c.a.User),!0;return!1};_Ewa.pD.prototype={t:null,j:null,y:null,v:0,u:0,m:null,p:null,r:null,s:null,q:!1,B:null,Q:3e4,o:null,w:null,x:null,A:!1,S:!0,z:null,D:null,d:function(n){this.eo("pcek",n)},h:function(n){this.ep("pcek",n)},l:null,a:function(){return this.k},n:null,b:function(n){var t=this.k[n];t&&this.bf(n,!1)},bx:function(n){this.r&&this.r!==n.b()&&(this.S=!1);this.l.f(n);this.r=n.b()},e:function(n,t,i,r){var u,f,o,e,s;i.val=[];r.val=[];u=this.k;for(f in u)o={key:f,value:u[f]},e=o.value,t?(s=_Ewa.h.C(n,this.j),this.ba(s,i.val,r.val,e)):this.Z(n,i.val,r.val,e)},c:function(n,t,i,r,u){var f=this.k[u];f&&(t?this.ba(n,i,r,f):this.Z(n,i,r,f))},f:function(){var r=[],u=this.k,t,n,l;for(t in u){var a={key:t,value:u[t]},f=a.value,e=f.a().SelectedRange;if(!isNullOrUndefined(e)&&_Ewa.a.a("OfficeVSO:5280212_Guard_PresenceState.SelectedRange"))for(var o=e,v=o.length,i=0;i<v;++i){var s=o[i],h=_Ewa.h.b(s),c=_Ewa.c.a(this.j).a().a().g();if(this.j.d().a().b()===s.SheetName&&h.d===c.d&&h.a===c.a){n=f.g();l=new Common.cY(n.User.UserID,n.User.UserName,n.UserColor,new Common.df(1),null,n.UserEmail,null,null,!1,!1,!1,n.JoinCoauthTime,null,0);Array.add(r,l);break}}}return r},i:function(){var n,t,i;_Ewa.eH.b=!0;_Ewa.eH.a=!0;n=this.k;for(t in n)i={key:t,value:n[t]},i.value.A()},g:function(){var n,t,i;_Ewa.eH.b=!1;_Ewa.eH.a=!1;n=this.k;for(t in n)i={key:t,value:n[t]},i.value.y()},dispose:function(){var n,t,i;if(this.by(),this.j&&(this.j.d()&&this.j.d().d(this.L),this.j.c()&&this.j.c().k(this.N),this.j.J(this.M)),this.s&&this.s.c(this.F),this.t&&(this.t.dispose(),this.t=null),this.k){n=this.k;for(t in n)i={key:t,value:n[t]},i.value.dispose()}System.a.b([this.l,this.p]);this.W();this.l=null;this.j=null;this.k=null;Array.clear(this.m);_Ewa.bW.prototype.dispose.call(this)},by:function(){this.l&&(this.l.k(this.K),this.l.j(this.G),this.l.l(this.I),this.l.m(this.J));this.y.b(this.H)},bq:function(){var i=this.n,t,r,n;for(t in i)r={key:t,value:i[t]},n=r.key,this.U(n)?(this.C(n,!0),delete this.o[n],delete this.n[n]):Diag.a.a(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",n)},be:function(n,t){var e={},u,o,b,it,c,l,a,i,f,r,k,d,rt,s,g,v,h,y,p,w,nt,tt;if(e.UpdatedCount=t.b?Object.keys(t.b).length:0,e.DisconnectedCount=t.a?t.a.length:0,_Ewa.a.a("OfficeVSO:5347991_AddComponentNamesToReport")&&(e.Location=Common.n.toString(30)),_Ewa.X.a(this.j).a(_Ewa.u.j,e,null,!1),u=null,this.j.n()&&(u=this.j.n().b("ModelUpdate","PresenceRendering"),u.d()),o={},t.b){_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(b=(new Date).getTime(),it=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fI,this.j.a(),435,436,1,null),function(n){var t=n.a();t.d(b)},this.j.g(),3,null,null));this.q||(this.R(!0),this.q=!0);c=t.b;for(l in c)(a={key:l,value:c[l]},i=a.key,this.x[i]=_Ewa.r.a().a(),f=a.value,this.X(i,new Date),this.bh(f),i!==this.r)&&(r=this.k[i],r||(this.U(i)?this.C(i,!0):(i in this.n?Diag.a.a(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",i):(this.o[i]=_Ewa.r.a().a(),o[i]=1),this.n[i]=!0,k=this.bk(i),this.k[i]=this.Y(k)),r=this.k[i]),r&&(r.o(f),f.SelectedRange&&f.SelectedRange.length>1?this.v++:this.u++,this.bg(i),this.O(r)));_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.j.b()&&this.j.b().bb()&&(d=(new Date).getTime(),rt=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fI,this.j.a(),435,436,1,null),function(n){var t=n.a();t.c(d)},this.j.g(),3,null,null))}if(t.a)for(s=0,g=t.a.length;s<g;s++)v=t.a[s],this.w[v]=_Ewa.r.a().a(),this.bf(v,!0);(t.a&&t.a.length>0||$$sc.j.a(o).length>0||$$sc.j.a(this.n).length>0)&&(h=[],Array.addRange(h,$$sc.j.a(o)),Array.addRange(h,$$sc.j.a(this.n)),y=this.j.a().a(_Ewa.ia,292,!1,null),y&&y.h(h,t.a));u&&u.a();this.A=!1;p=this.k;for(w in p)if(nt={key:w,value:p[w]},tt=$$as(_Ewa.sR,nt.value).a().CollabMode,!tt){this.A=!0;break}this.em("pcek",t,null)},bz:function(n,t){t&&this.j.b().D()&&(t.a.HasAnyNonOcsCoauthor=this.A)},Y:function(n){return new _Ewa.pE(n,this.j,this.p)},U:function(n){var t=this.j.b().bN(n),i;return t&&(n in this.k?this.k[n].B(t):(i=this.Y(t),this.k[n]=i,this.O(i))),!!t},ba:function(n,t,i,r){var u,f,s;if(n)for(var h=n,l=h.length,e=0;e<l;++e){if(u=h[e],u){if(f=_Ewa.gg.b(u,this.j,1),f&&_Ewa.pD.a(f.R,t,i,r))return;if(f=_Ewa.gg.b(u,this.j,2),f&&_Ewa.pD.a(f.R,t,i,r))return}if(r.a().SelectedRange)for(var c=r.a().SelectedRange,a=c.length,o=0;o<a;++o)if(s=c[o],s&&u&&_Ewa.gg.a(u,s)){Array.add(r.a().PresenceType===1?i:t,r.c.a.User);return}}},Z:function(n,t,i,r){n&&_Ewa.pD.a(this.bj(n),t,i,r)},br:function(){var t=new Common.gf({},null),i=this.k;for(var r in i){var u={key:r,value:i[r]},f=u.key,e=u.value,n=e.a();n.SelectedRange=n.SelectedRangeRaw;t.b[f]=n}this.be(this,t)},bh:function(n){n.SelectedRange&&(n.SelectedRangeRaw=this.bi(n.SelectedRange),n.SelectedRange=this.y.d(n.SelectedRange))},bi:function(n){for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=_Ewa.gg.c(n[t]);return i},bj:function(n){if(n)switch(n.a){case 0:var t=this.j.m().bD(n.b);return t?t.R:null;case 2:return n.E;default:return null}return null},bl:function(){this.l.c(this.K);this.l.d(this.I);this.l.b(this.G);this.l.e(this.J);this.y.a(this.H)},bd:function(n,t,i,r){var u={};u.a=this.j.e().UserSessionId;u.b=n;u.c=i?"PendingUserRemoved":"Non-PendingUserRemoved";u.d=r?"Disconnected":"Inactivity";u.e=t;_Ewa.D.a().a(22,u,!0)},bf:function(n,t){if(n in this.k){this.bg(n);var i=this.k[n];i.dispose();delete this.k[n];Diag.a.a(38322520,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",n);this.bd(n,_Ewa.r.a().a(),!1,t)}n in this.n&&(this.C(n,!1),delete this.o[n],delete this.n[n],Diag.a.a(38322521,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",n),this.bd(n,_Ewa.r.a().a(),!0,t))},bg:function(n){for(var u,t=this.m.length-1;t>=0;t--)if(this.m[t].User.UserID===n){Array.removeAt(this.m,t);for(var r=this.k[n].b(),f=r.length,i=0;i<f;++i)u=r[i],this.p.n(u.u.y,!1);this.E()}},bt:function(){this.bb()},bo:function(){this.B&&_Ewa.bT.a(_Ewa.r.a(),this.B)<this.Q||(this.B=_Ewa.r.a().a(),this.P(),this.bm(),this.bn(),this.q||this.R(!1))},bn:function(){(this.u||this.v)&&(this.j.v(-70383382,-1,0,null),Diag.a.a(41477068,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.v,this.u));this.u=0;this.v=0},bu:function(){var n,t,i;this.bb();n=this.k;for(t in n)i={key:t,value:n[t]},this.O(i.value)},bv:function(){this.P();this.q||this.R(!1);this.q=!1},W:function(){this.P();this.o=null;this.n=null},P:function(){var t=this.n,n,i;for(n in t)i={key:n,value:t[n]},this.C(i.key,!1)},bm:function(){var f=this.w,n,t,i,r,u;for(n in f)t={key:n,value:f[n]},this.bc(t.key,!0,t.value);i=this.x;for(r in i)u={key:r,value:i[r]},this.bc(u.key,!1,u.value);this.w={};this.x={}},C:function(n,t){var i,r;this.j.j()&&this.j.b().a()&&(i={},i.a=this.j.e().UserSessionId,i.b=n,i.c=t,i.e=!1,i.d=-1,i.f=_Ewa.r.a().a(),this.j.b()&&(i.e=this.j.b().C()),r=this.o[n],r&&(i.d=_Ewa.bT.a(_Ewa.r.a(),r)),_Ewa.D.a().a(20,i,!0))},R:function(n){if(this.j.j()){var t={};t.e=-1;t.f=-1;t.c=!1;t.d=!1;t.b=n;t.a=this.j.e().UserSessionId;this.j.b()&&(t.c=this.j.b().bb(),t.d=this.j.b().C(),t.e=this.j.b().u().length,this.j.b().be()&&(t.f=_Ewa.bT.a(_Ewa.r.a(),this.j.b().cr())));_Ewa.D.a().a(21,t,!0)}},bc:function(n,t,i){if(this.j.j()){var r={};r.a=this.j.e().UserSessionId;r.b=n;r.c=t;r.d=i;_Ewa.D.a().a(19,r,!0)}},bb:function(){var f=[],e=this.k,i,o,n,t,h,l;for(i in e)if(o={key:i,value:e[i]},n=o.value,this.l.a(n.a())){this.V(f,n);Array.remove(this.m,n.c.a);this.l.g().PresenceType===1&&(t={},t.a=n.a().PresenceType===1?"Editing":"Non-Editing",t.b=this.j.e().UserSessionId,t.c=_Ewa.r.a().a(),_Ewa.D.a().a(18,t,!1));for(var s=n.b(),a=s.length,r=0;r<a;++r)h=s[r],this.p.n(h.u.y,!0)}else for(var c=n.b(),v=c.length,u=0;u<v;++u)l=c[u],this.p.n(l.u.y,!1);Array.clear(this.m);this.m=f;this.E()},V:function(n,t){var r=t.c.a,u,i;if(t.a().PresenceType)Array.add(n,r);else{for(u=n.length,i=0;i<u;i++)if(this.k[n[i].User.UserID].a().PresenceType)break;Array.insert(n,i,r)}},bs:function(){var t=this.k,n,i;for(n in t)i={key:n,value:t[n]},i.value.dispose();this.k={};this.W();this.o={};this.n={};Array.clear(this.m);this.E()},bp:function(n,t){this.bx(t.a)},O:function(n){var u,t,i,r;this.l.a(n.a())&&(this.V(this.m,n),this.E());u=n.c.a.User.UserID;t=this.k;for(i in t)r={key:i,value:t[i]},r.key!==u&&n.x(r.value)},E:function(){this.m.length>0&&this.bw(!0)},bw:function(n){for(var t,o,u,i=0,f=this.m.length;i<f;i++)if(t=this.k[this.m[i].User.UserID],t)if(n)if(this.l.i(t.a())){t.p(!0);for(var e=t.b(),s=e.length,r=0;r<s;++r)o=e[r],this.p.n(o.u.y,!0)}else u=this.l.h(t.a()),u&&t.q(!0,u);else t.p(!1),t.q(!1,null)},bk:function(n){var t={};return t.User={},t.User.UserID=n,t.User.UserName=_Ewa.ClientStringManager.a().c(84),t.UserColor="#AAAAAA",t},X:function(n,t){if(this.S&&this.z){if(!n||!t){Diag.a.a(42481443,0,15,"userId: [{0}], endTime: [{1}]",n,t);return}if(this.D){this.D.a(n,t,this.r,0);return}var i=this;this.z.CW(function(){i.D=i.z.a();i.X(n,t)})}}};_Ewa.eH=function(){};_Ewa.hx=function(n,t){this.E=Function.createDelegate(this,this.Z);this.I=Function.createDelegate(this,this.be);this.J=Function.createDelegate(this,this.bf);this.K=Function.createDelegate(this,this.bg);this.F=Function.createDelegate(this,this.ba);this.B=Function.createDelegate(this,this.V);this.H=Function.createDelegate(this,this.bd);this.D=Function.createDelegate(this,this.Y);this.u=Function.createDelegate(this,this.X);this.C=Function.createDelegate(this,this.W);this.G=Function.createDelegate(this,this.bc);this.y=Function.createDelegate(this,this.bb);this.L=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bi);_Ewa.hx.initializeBase(this,[!1]);this.n=n;this.q=_Ewa.c.a(this.n).a();this.w=t;this.n.B(this.M);this.n.D(this.L);this.o={};this.s=new Common.cY(null,null,null,null,null,null,null,null,!1,!1,!1,0,null,0);this.r={};this.r.b=0;this.r.c=0;this.z=new _Ewa.hx.e(this.n)};_Ewa.hx.a=function(){return _Ewa.hx.b||(_Ewa.hx.b={ApplyFilter:1,ApplyPivot:0,ApplyPivotSort:0,ApplyPivotSortByValue:1,ApplyWellKnownPivotFilter:0,RemovePivotFilter:0,SetCustomFilter:1,SetTop10Filter:1,TogglePivotDrill:0,RefreshAll:2})};_Ewa.hx.d=function(n,t){return!!n&&!!n.ObjectId&&!!t&&!!t.ObjectId&&(!n.ObjectType||n.ObjectType===2)&&n.ObjectType===t.ObjectType&&!n.ObjectId.localeCompare(t.ObjectId)};_Ewa.hx.c=function(n,t){return!n.NamedObjectName&&_Ewa.gg.a(n,t)};_Ewa.hx.prototype={n:null,w:null,q:null,p:null,s:null,t:null,r:null,z:null,c:function(n){this.eo("presenceChanged",n)},k:function(n){this.ep("presenceChanged",n)},b:function(n){this.n.b().Q(n)},j:function(n){this.n.b().T(n)},e:function(n){this.eo("selectionChanged",n)},m:function(n){this.ep("selectionChanged",n)},d:function(n){this.eo("presenceDisabled",n)},l:function(n){this.ep("presenceDisabled",n)},o:null,g:function(){return this.o},Q:function(){return!this.n.b()||this.n.b().I()},dispose:function(){this.n&&(this.P(),this.n.C(this.M),this.n.J(this.L));this.p&&this.p.i(this.y);System.a.a(this.z);this.p=null;this.n=null;_Ewa.bW.prototype.dispose.call(this)},f:function(n){this.p?this.p.i(this.y):this.R();this.p=n;this.p?(this.p.f(this.y),this.x(!0)):this.P()},R:function(){var i,t,r,n;this.q.g(this.G);_Ewa.c.a(this.n).O(this.C);i=_Ewa.c.a(this.n).f();i.h(this.u);i.d(this.D);this.n.b().g(this.H);this.n.b().bx(this.B);this.w.a(this.F);t=this.n.c().a();t.t(this.K);t.d(this.J);t.c(this.I);r=_Ewa.l.b(_Ewa.eG,this.n.a(),16,74,1,null);n=this;_Ewa.g.a(r,function(t){n.t=t.a();n.t.T(n.E);n.t.S(n.u)},$$sc.f.a,3,null,null)},P:function(){this.q.i(this.G);_Ewa.c.a(this.n).P(this.C);var n=_Ewa.c.a(this.n).f();n.g(this.u);n.c(this.D);this.n.b().j(this.H);this.n.b().bP(this.B);this.w.b(this.F);this.t&&(this.t.bm(this.E),this.t.bl(this.u),this.n.c().a().v(this.K),this.n.c().a().g(this.J),this.n.c().a().f(this.I));this.em("presenceDisabled",null,null)},a:function(n){return this.i(n)||!!this.h(n)},i:function(n){var f,e,t,i,o,s,r,u;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(f=this.o.Object.length,e=n.Object.length,t=0;t<f;t++)for(i=0;i<e;i++)if(this.U(this.o.Object[t],n.Object[i]))return!0;if(this.o.SelectedRange&&n.SelectedRange)for(o=this.o.SelectedRange.length,s=n.SelectedRange.length,r=0;r<o;r++)for(u=0;u<s;u++)if(_Ewa.hx.c(this.o.SelectedRange[r],n.SelectedRange[u]))return!0;return!1},h:function(n){var r,u,t,i;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(r=this.o.Object.length,u=n.Object.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.hx.d(this.o.Object[t],n.Object[i]))return this.o.Object[t].ObjectId;return null},U:function(n,t){return!!n&&!!t&&n.ObjectType===t.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!!n.ObjectId&&!!t.ObjectId&&!n.ObjectId.localeCompare(t.ObjectId)},T:function(){this.x(!1)},x:function(n){this.q.b().a()?this.N(0,n):this.O(_Ewa.c.a(this.n).f().e()?1:0,n)},N:function(n,t){var u={},r,i,f;if(this.n.A(u),this.q.b().a()){if(r=this.q.b().a().a(),u.FirstColumn=-1,u.FirstRow=-1,u.LastColumn=-1,u.LastRow=-1,u.NamedObjectName=r?r.h():null,this.o.SelectedRange=[u],this.o.PresenceType=0,i=null,r)switch(r.a){case 0:f=this.n.m().bD(r.b);f&&(i={},i.ObjectType=this.v(0),i.ObjectPresenceType=n,i.ObjectId=f.R);break;case 2:r.b&&(i={},i.ObjectType=this.v(9),i.ObjectPresenceType=n,i.ObjectId=r.E)}this.o.Object=[i]}this.em("selectionChanged",null,null);this.A(t)},O:function(n,t){var u,f,s,r,i;if(!_Ewa.c.a(this.n).m()&&!_Ewa.c.a(this.n).y()){u=this.n.n().b("ModelUpdate","SendRangePresence");u.d();f=_Ewa.h.C(this.q.a().b(),this.n);this.o.SelectedRange=this.w.c(f);this.o.Object=[];for(var o=f,h=o.length,e=0;e<h;++e)s=o[e],r=_Ewa.gg.b(s,this.n,1),r&&(i={},i.ObjectType=this.v(r.Q),i.ObjectPresenceType=0,i.ObjectId=r.R,Array.add(this.o.Object,i));this.o.PresenceType=n;this.em("selectionChanged",null,null);this.o.SelectedRange||this.o.Object?this.A(t):Diag.a.a(41185635,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.p.b());u.a()}},A:function(n){if((this.n.b().bC()||!this.n.b().bo()||n)&&(this.Q()||++this.r.b,this.p)){if(this.o.Version=2,this.o.ClientType=1,this.o.ChatThreadId=this.s.u,this.o.ChatThreadDiscoveryUri=this.s.t,this.o.InChat=this.s.v,this.o.Cid=this.s.s,this.o.SupportsChat=!!this.s.q&&this.s.q.a(4),this.o.CollabMode=this.n.b().W()?2:0,this.o.OcsCapable=this.n.b().bI(),this.p.r(this.o),_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.n.b()&&this.n.b().bb()){var t=(new Date).getTime(),i=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fI,this.n.a(),435,436,1,null),function(n){var i=n.a();i.e(t)},this.n.g(),3,null,null)}this.Q()||++this.r.c}},W:function(){this.n&&this.N(0,!1)},Y:function(){this.o.PresenceType=1;this.em("selectionChanged",null,null);this.A(!1)},X:function(){this.x(!1);this.S()},Z:function(){this.q.b().a()?this.N(1,!1):this.O(0,!1)},bb:function(n,t){this.em("presenceChanged",t,null)},bc:function(){this.O(_Ewa.c.a(this.n).m()?1:0,!1)},bd:function(n,t){_Ewa.nF.a(t)&&(this.o={})},ba:function(){this.T()},bg:function(n,t){var i,e,c,o,h,u,f,r;if(t&&t.b in _Ewa.hx.a()){i=null;e=!1;switch(_Ewa.hx.a()[t.b]){case 0:i=t.c.cell;break;case 1:i=t.c.parameters.Location;break;case 2:c=this.q.a().e();i=_Ewa.h.a(c,this.n);e=!0;break;default:return}if(i.LastColumn=i.FirstColumn,i.LastRow=i.FirstRow,i.NamedObjectName=null,this.o.SelectedRange=[i],this.o.PresenceType=0,e){o=[];for(var l=this.n.m().bY(1),a=l.length,s=0;s<a;++s)h=l[s],u={},u.ObjectType=this.v(h.Q),u.ObjectPresenceType=1,u.ObjectId=h.R,Array.add(o,u);this.o.Object=o}else f=_Ewa.gg.b(i,this.n,1),r=null,f&&(r={},r.ObjectType=this.v(f.Q),r.ObjectPresenceType=0,r.ObjectId=f.R),this.o.Object=[r];this.em("selectionChanged",null,null);this.A(!1)}},be:function(n,t){t.a.a in _Ewa.hx.a()&&(this.o.Object=[null],this.x(!1))},bf:function(n,t){t.b.a in _Ewa.hx.a()&&(this.o.Object=[null],this.x(!1))},bi:function(n,t){t.b||(this.o={},this.n.j()?this.R():this.P())},bh:function(){this.S()},S:function(){this.n.j()&&(this.r.a=this.n.e().UserSessionId,_Ewa.D.a().a(26,this.r,!0));this.r.b=0;this.r.c=0},v:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}},V:function(){this.T();this.z.c()}};_Ewa.hx.e=function(n){_Ewa.hx.e.initializeBase(this,[!1]);this.a=n;var t=this;this.a.a().c(_Ewa.cg,29,function(n){t.b=n;n.c(t)},null)};_Ewa.hx.e.prototype={a:null,b:null,l:function(n){this.eo("OSC",n)},k:function(n){this.ep("OSC",n)},c:function(){this.em("OSC",null,null)},f:function(n,t){if(n==="QueryOcsConnectionStatus")t.Value=this.a.b().W()?_Ewa.ClientStringManager.a().a(860):_Ewa.ClientStringManager.a().a(861);else return!1;return!0},h:function(){return!0},dispose:function(){this.b&&(this.b.b(this),this.b=null);this.a=null;_Ewa.bW.prototype.dispose.call(this)}};_Ewa.Xa=function(n){_Ewa.Xa.initializeBase(this);this.m=n;this.l()};_Ewa.Xa.prototype={m:null,i:null,a:function(){if(this.i)this.k(this.i);else{var n=this;_Ewa.g.a(_Ewa.l.a(_Ewa.nm,this.m.a(),28,this.h(),this.j,null),function(t){n.k(n.i||(n.i=new _Ewa.hx(n.m,t.a())))},this.h(),3,null,null)}}};_Ewa.Xb=function(n,t,i,r,u){this.L=Function.createDelegate(this,this.W);this.G=Function.createDelegate(this,this.V);this.Q=Function.createDelegate(this,this.Z);this.J=Function.createDelegate(this,this.X);this.z=[];_Ewa.Xb.initializeBase(this,[!1]);this.y=n;this.w=t;this.O=n.id;this.A=r;this.K=u;this.E=!1;this.S();this.M=i;this.C=null;this.x={};this.x.FirstColumn=0;this.x.FirstRow=0;this.x.LastColumn=0;this.x.LastRow=0};_Ewa.Xb.prototype={w:null,y:null,B:null,E:!1,I:!1,x:null,C:null,F:null,K:null,D:null,j:function(n){this.eo("hidePresenceTooltip",n)},p:function(n){this.ep("hidePresenceTooltip",n)},m:function(n){this.eo("showPresenceTooltip",n)},r:function(n){this.ep("showPresenceTooltip",n)},l:function(n){this.eo("showFullPresenceTooltip",n)},q:function(n){this.ep("showFullPresenceTooltip",n)},k:function(n){this.eo("presenceChanged",n)},s:function(n){this.ep("presenceChanged",n)},O:null,a:function(){return this.O},M:null,c:function(){return this.M},A:0,b:function(){return this.A},h:function(){if(!this.y)return null;var t=this.w.n(this.A).v(),u=this.w.d(),f=this.y.offsetWidth;if(!this.C&&f<=4){if(this.x){var n=this.w.s(),i=this.x.FirstRow,r=u?this.x.FirstColumn:this.x.LastColumn;if(n&&!(i>=n.a&&i<=n.c&&r>=n.b&&r<=n.d))return i=i<=n.a?t.a.b:t.a.b+(i>=n.c?t.d():t.d()/2),r=r<=n.b?t.a.a:t.a.a+(r>=n.d?t.c():t.c()/2),this.F=new Sys.UI.Point(r,i)}return this.F}if(this.C){var s=this.y.offsetTop-2,e=parseInt(this.y.style.left),o=0;return u&&(o=parseInt(this.y.parentNode.style.width)-f-e-(this.w.bl().b()&&this.w.bl().c()?_Ewa.bf.a():0)),this.F=new Sys.UI.Point((u?o:e)+f+4,s)}return this.F=new Sys.UI.Point(parseInt(u?this.y.style.right:this.y.style.left)+f,this.y.offsetTop)},H:!1,g:function(){return this.H},t:function(n){return this.H=n,n},N:null,i:function(){return _Ewa.h.b(this.x)},dispose:function(){this.em("hidePresenceTooltip",null,null);this.em("presenceChanged",null,null);this.R();this.P();System.a.a(this.D);this.w=null;this.y=null;this.N=null;_Ewa.bW.prototype.dispose.call(this)},u:function(n,t){var i=!!n&&!_Ewa.h.b(n).g(_Ewa.h.b(this.x)),r=!!t&&(!this.C||this.C.X()!==t.X());(i||r)&&(this.em("presenceChanged",null,null),this.R(),this.H=!1,this.x=n,this.C=t,this.F=null)},o:function(n){this.H=!1;this.I=!1;n&&this.em("hidePresenceTooltip",null,null)},n:function(n){Array.add(this.z,n);this.S();n.k(this.J)},e:function(n,t){if(n){if(this.I=!0,t){var i=this.K.e().ShowTooltipDelayInMs;this.D=_Ewa.cR.a(this.Q,i,_Ewa.o.da,this.D)}}else this.o(t)},f:function(n){this.N=n},v:function(){if(this.y&&this.I){this.B=_Ewa.b.h(this.y);var n=Math.floor(this.B.x);this.B.x=n===this.B.x?n:n+1;this.B.y=Math.floor(this.B.y)}},d:function(){var n,t,i;return this.x?_Ewa.a.b(781)?(n=this.U(),!n)?!1:this.w.dz(n,this.A):(t=this.w.n(this.A).v(),i=this.w.w(this.i(),this.A,!1,!1),t.i(i)):!1},U:function(){var n,t;return this.i().o()?(n=this.w.b().u(this.i(),this.K.F()),!n)?null:(t=n.g(this.i(),!0,!1),!t)?null:t.e():this.i()},Z:function(){(System.a.a(this.D),this.D=null,this.I)&&(this.d()?this.em("showPresenceTooltip",null,null):this.o(!0))},R:function(){for(var n=0,t=this.z.length;n<t;n++)this.z[n].s(this.J);Array.clear(this.z);this.P()},S:function(){!this.E&&this.z.length>=1&&(this.E=!0,this.w.b().i(this.G),this.w.b().f(this.G),this.w.j().d(this.L))},P:function(){this.E&&!this.z.length&&(this.E=!1,this.w&&(this.w.b().k(this.G),this.w.b().e(this.G),this.w.j().c(this.L)))},Y:function(n){n.s(this.J);Array.remove(this.z,n);this.P()},X:function(n){var t=n;this.Y(t)},V:function(){this.T()},W:function(){this.T()},T:function(){this.v();for(var n=0,t=this.z.length;n<t;n++)this.z[n].v()}};_Ewa.pE=function(n,t,i){this.r=Function.createDelegate(this,this.L);this.s=Function.createDelegate(this,this.M);this.e=new _Ewa.y(!0);_Ewa.pE.initializeBase(this);this.c=new _Ewa.Bk(n);this.z(n);this.f=i;this.n([]);this.d=t;this.d.d().c(this.s);_Ewa.c.a(this.d).X(this.r)};_Ewa.pE.a=function(n,t,i,r,u,f){var e=n===1?37:36;r&&i&&r.a()===i.SheetName?(t.val.b(_Ewa.h.b(i),[e],!0),t.val.Y(e),Diag.a.b(41754975,0,t.val.u.y===u.User.UserID,"UserID and UnitID should match"),f.M(t.val.u.y,n===1)):t.val.bn([e])};_Ewa.pE.prototype={d:null,f:null,i:0,j:0,t:0,a:function(){return this.c.d()},o:function(n){return this.c.e(n),this.w(),n},A:function(){for(var t,n=0;n<this.b().length;n++)this.b()[n].Y(37),this.b()[n].Y(36);for(t=0;t<this.e.a.length;t++)this.e.a[t].b()},y:function(){for(var t,n=0;n<this.b().length;n++)this.b()[n].bn([37,36]);for(t=0;t<this.e.a.length;t++)this.e.a[t].j()},dispose:function(){this.d&&(this.d.d()&&this.d.d().d(this.s),_Ewa.c.a(this.d).T(this.r));this.C();System.a.b(this.b());System.a.b([this.c]);this.d=null;this.c=null;this.n(null);this.e=null;_Ewa.biZ.prototype.dispose.call(this)},C:function(){if(this.e){for(var n=0;n<this.e.a.length;n++)this.e.a[n].dispose();this.e.f()}},x:function(n){this.a().Version===1?this.G(n):this.H(n)},G:function(n){var r,u,t,i;if(n.a().SelectedRange&&this.a().SelectedRange)for(r=this.a().SelectedRange.length,u=n.a().SelectedRange.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.gg.a(this.a().SelectedRange[t],n.a().SelectedRange[i])){this.b()[t].W(n.h(i));return}},H:function(n){var e=0,o=0,p,s,t,i,h,c,r,l,a,w,b,u,f,v,y;if(this.a()&&this.a().Object&&n.a()&&n.a().Object)for(p=this.a().Object.length,s=n.a().Object.length,t=0;t<p;t++)if(this.a().Object[t]&&this.v(this.a().Object[t])){for(e++,i=0;i<s;i++)if(n.a().Object[i]&&this.v(n.a().Object[i])&&(o++,this.F(this.a().Object[t],n.a().Object[i])&&(h=this.h(e),c=n.h(o),h&&c))){h.W(c);return}}else if(this.a().Object[t]&&n.a().Object[t]&&(!this.a().Object[t].ObjectType||this.a().Object[t].ObjectType===2))for(r=0;r<s;r++)if(n.a().Object[r]&&(!n.a().Object[t].ObjectType||n.a().Object[t].ObjectType===2)&&this.a().Object[t].ObjectId===n.a().Object[r].ObjectId&&(l=this.m(this.a().Object[t].ObjectId),a=n.m(this.a().Object[t].ObjectId),l&&a)){l.l(a);return}if(n.a().SelectedRange&&this.a().SelectedRange)for(w=this.a().SelectedRange.length,b=n.a().SelectedRange.length,u=0;u<w;u++)for(f=0;f<b;f++)if(_Ewa.gg.a(this.a().SelectedRange[u],n.a().SelectedRange[f])&&(v=this.h(e+u),y=n.h(o+f),v&&y)){v.W(y);return}},F:function(n,t){return!!n&&!!t&&t.ObjectType===n.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!n.ObjectId.localeCompare(t.ObjectId)},h:function(n){return n>=0&&this.b().length>n?this.b()[n]:null},p:function(n){for(var t=0,i=this.b().length;t<i;t++)this.b()[t].bo(n)},m:function(n){return n&&this.e.d(n)?this.e.b[n]||null:null},q:function(n,t){var r,i,u;if(n)r=this.e.b[t]||null,r&&r.k(!0);else for(i=0;i<this.e.a.length;i++)u=this.e.a[i],u&&u.k(!1)},B:function(n){_Ewa.sR.a(this,n)},u:function(n,t){if(n<t)return this.b()[n];if(!this.g()||!this.d||!this.f)return null;var i=new _Ewa.gh(this.g(),this.d,this.f);return Array.add(this.b(),i),i},N:function(){for(var t,f,e,i,r=this.b().length,u=this.a().SelectedRange?this.a().SelectedRange.length:0,o=this.d.d().a(),n=0;n<u;n++)(t=this.u(n,r),t&&this.a().SelectedRange[n])&&(this.a().SelectedRange[n].NamedObjectName?t.a([37,36]):(t.Z(this.a().SelectedRange[n],this.a().PresenceType),_Ewa.pE.a(this.a().PresenceType,f={val:t},this.a().SelectedRange[n],o,this.g(),this.f),t=f.val));for(e=!!this.c&&!!this.c.b&&this.c.b.PresenceType!==this.c.d().PresenceType,i=e?0:u;i<r;i++)this.b()[i].a([this.c.b.PresenceType===1?37:36])},v:function(n){if(n&&n.ObjectId&&(this.D(n.ObjectType)===1||this.D(n.ObjectType)===2)){var t=this.d.m().bE(n.ObjectId);if(t)return _Ewa.h.W(t)}return null},O:function(){for(var u,f,n,e,o,l,i,t,a,v,s,y,h=this.b().length,r=this.d.d().a(),p=this.a().SelectedRange?this.a().SelectedRange.length:0,w=this.a().Object?this.a().Object.length:0,c=0;c<h;c++)this.b()[c].a([37,36]);for(this.I(),u=0,this.i=0,this.j=0,f=0;f<w;f++)n=this.a().Object[f],e=this.v(n),e&&(o=this.u(u,h),n.ObjectType===1?this.i++:n.ObjectType===3&&this.j++,u++,o.Z(e,n.ObjectPresenceType),_Ewa.pE.a(n.ObjectPresenceType,l={val:o},e,r,this.g(),this.f),o=l.val);for(i=0;i<p;i++)if(this.a()&&this.a().SelectedRange&&(t=this.a().SelectedRange[i],!t.NamedObjectName)){if(a=!!r&&t.SheetName===r.a(),v=!!_Ewa.gg.b(t,this.d,1),a&&v)continue;s=this.u(u+i,h);s.Z(t,this.a().PresenceType);_Ewa.pE.a(this.a().PresenceType,y={val:s},t,r,this.g(),this.f);s=y.val}(this.t=this.E())>0&&Diag.a.a(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')},I:function(){this.E();this.C()},E:function(){var t=0,n,i;if(this.a()&&this.a().Object)for(n=0;n<this.a().Object.length;n++)i=this.a().Object[n],this.P(i)&&t++;return t},J:function(n,t){var r,i;return this.e.d(t)?(r=this.e.b[t]||null,r.a(n),r):!this.g()||!this.d||!this.f?null:(i=new _Ewa.WU(this.g(),this.d,this.f),i.a(n),this.e.c(t,i),i)},P:function(n){var r=!1,t,i;if(n&&n.ObjectId&&(!n.ObjectType||n.ObjectType===2))try{t=this.K(n);t&&(i=this.J(t,n.ObjectId),i.c(t,n.ObjectPresenceType),i.b(),r=!0)}catch(u){Diag.a.a(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',u.stack);throw u;}return r},K:function(n){var t,r,i;return n?(t=null,n.ObjectType===2?t=_Ewa.U.a(this.d).f(n.ObjectId):n.ObjectType||(r=this.d.m(),i=r.bE(n.ObjectId),i&&i.U&&(t=_Ewa.U.a(this.d).J(i.U))),t):null},w:function(){try{this.a().Version===1?(this.N(),Diag.a.a(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.O(),Diag.a.a(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.t,this.i,this.j))}catch(n){Diag.a.a(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',n.stack);throw n;}},L:function(){this.w()},M:function(){this.w()},D:function(n){switch(n){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}}};_Ewa.Bk=function(n){_Ewa.Bk.initializeBase(this,[!1]);this.a=n;this.c=null;this.b=null};_Ewa.Bk.prototype={c:null,a:null,d:function(){return this.c||{}},e:function(n){return this.b=this.c,this.c=n,this.em("userPresenceChanged",null,null),n},b:null,dispose:function(){this.em("userPresenceChanged",null,null);this.em("userLeft",null,null);this.a=null;this.c=null;this.b=null;_Ewa.bW.prototype.dispose.call(this)}};_Ewa.bpx=function(){};_Ewa.bpx.b=function(){_Ewa.m.a(function(n){var t,i,r;_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&_Ewa.Bi.a(n);t=n.a();t.b(_Ewa.bnd.$$(_Ewa.nm),28,new _Ewa.WV(n));t.b(_Ewa.bnd.$$(_Ewa.pC),158,new _Ewa.Xa(n));_Ewa.m.a(_Ewa.sT.a);i=_Ewa.l.a(_Ewa.pC,n.a(),158,t.d(),1,null);r=_Ewa.l.a(_Ewa.nm,n.a(),28,t.d(),1,null);_Ewa.g.a(_Ewa.g.b([i,r],t.d(),3),function(){var f=new($$sc.D.$$(Common.em)),e=t.a(_Ewa.kt,26,!1,null),u;e.f(f.h);u=new _Ewa.pD(n,e,i.a(),r.a(),Common.Utils.b.a(Common.App.CoauthTelemetry.b,Common.Utils.a.a().b(Common.App.CoauthTelemetry.b,null)));_Ewa.eQ.a(n.a()).a(u);t.b(_Ewa.bnd.$$(Common.eS),159,new _Ewa.sT);_Ewa.g.a(_Ewa.l.a(Common.eS,t,159,t.d(),1,null),function(t){var r=new($$sc.D.$$(Common.hC)),i,e;r.b(u);e=new Common.App.Presence.a((i=new Common.cY,i.n=n.k().ClientId,i),f.a,r.a,t.a(),Common.S.a(),Common.a.a.a("AwayStatusOneMinuteTimeoutIsEnabled")?6e4:Common.a.a.c("AwayCoauthorThresholdMs",9e5),Common.a.c().t,_Ewa.bpx.a.b(),!1)},t.d(),3,null,null)},t.d(),3,null,null);Common.Utils.a.a().c(_Ewa.Ph,null).c(Common.dq,null).a().b(function(){return n.b()});Common.Utils.a.a().a(Common.dq,null);Common.Utils.a.a().c(_Ewa.Bh,null).c(Common.cf,null).a().b(function(){return new _Ewa.Bh(n)});Common.Utils.a.a().a(Common.cf,null)})};_Ewa.bpx.a=function(){};_Ewa.bpx.a.b=function(){return _Ewa.bpx.a.a||(_Ewa.bpx.a.a=new _Ewa.bpx.a),_Ewa.bpx.a.a};_Ewa.bpx.a.prototype={a:function(){Diag.a.a(38339419,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")},b:function(n,t){return new CommonUI.p(n,t)},dispose:function(){}};_Ewa.WZ=function(){};_Ewa.WZ.a=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetNamedSheetViewConversion",e,t,i,r,u,132,null,null)};_Ewa.gg=function(){};_Ewa.gg.c=function(n){var t={};return t.SheetName=n.SheetName,t.FirstColumn=n.FirstColumn,t.FirstRow=n.FirstRow,t.LastRow=n.LastRow,t.LastColumn=n.LastColumn,t.NamedObjectName=n.NamedObjectName,t};_Ewa.gg.a=function(n,t){return!!n&&!!t&&n.SheetName===t.SheetName&&(!!n.NamedObjectName&&n.NamedObjectName===t.NamedObjectName||!n.NamedObjectName&&!t.NamedObjectName&&_Ewa.h.b(n).h(_Ewa.h.b(t)))};_Ewa.gg.b=function(n,t,i){var u,r;if(!t||!t.m())return null;for(u=0;u<t.m().e();u++)if(r=t.m().g(u),r&&r.Q===i&&r.O&&r.O.i(_Ewa.h.b(n))&&_Ewa.f.b(r.P,n.SheetName,!0))return r;return null};_Ewa.Bg=function(){};_Ewa.Bg.a=function(n,t,i){if(!t)return null;var r=n.z();return new Sys.UI.Point(t.x+r.a*(i?1:-1),t.y+r.b*(i?1:-1))};_Ewa.Vh.registerClass("_Ewa.Vh",_Ewa.bW,_Ewa.nm,Sys.IDisposable);_Ewa.WU.registerClass("_Ewa.WU",null,_Ewa.bpv,Sys.IDisposable);_Ewa.sR.registerClass("_Ewa.sR",_Ewa.biZ);_Ewa.WV.registerClass("_Ewa.WV",_Ewa.td.$$(_Ewa.nm));_Ewa.gI.registerClass("_Ewa.gI",_Ewa.bW,Common.App.CollabControls.l,Sys.IDisposable);_Ewa.sS.registerClass("_Ewa.sS",_Ewa.bW,_Ewa.bpw,Sys.IDisposable);_Ewa.Bh.registerClass("_Ewa.Bh",null,Common.cf,Sys.IDisposable);_Ewa.sT.registerClass("_Ewa.sT",_Ewa.td.$$(Common.eS));_Ewa.gh.registerClass("_Ewa.gh",_Ewa.hq);_Ewa.Bi.registerClass("_Ewa.Bi",_Ewa.td.$$(_Ewa.fI));_Ewa.Bj.registerClass("_Ewa.Bj",null,Sys.IDisposable);_Ewa.pD.registerClass("_Ewa.pD",_Ewa.bW,_Ewa.lL,Common.hC);_Ewa.hx.registerClass("_Ewa.hx",_Ewa.bW,_Ewa.pC,Sys.IDisposable);_Ewa.hx.e.registerClass("_Ewa.hx.e",_Ewa.bW,Sys.IDisposable,_Ewa.yW,Common.IRootUser);_Ewa.Xa.registerClass("_Ewa.Xa",_Ewa.td.$$(_Ewa.pC));_Ewa.Xb.registerClass("_Ewa.Xb",_Ewa.bW,_Ewa.bpw,Sys.IDisposable);_Ewa.pE.registerClass("_Ewa.pE",_Ewa.sR);_Ewa.Bk.registerClass("_Ewa.Bk",_Ewa.bW);_Ewa.gI.b=null;_Ewa.gh.c=[36,37];_Ewa.gh.a=null;_Ewa.eH.b=!1;_Ewa.eH.a=!1;_Ewa.hx.b=null;_Ewa.bpx.a.a=null;_Ewa.bpx.b();Type.registerNamespace("_Ewa");_Ewa.sU=function(n,t,i){this.g=Function.createDelegate(this,this.i);_Ewa.sU.initializeBase(this,[!1]);this.e=t;this.h=n;this.d=i;this.b=[];i.d(this.g);this.e.a().b(_Ewa.pF,231,this)};_Ewa.sU.a=function(n,t){var i,r,u,f;return!n.length&&!t.length?"":t.length?t.length===1?(i=_Ewa.ClientStringManager.a().c(80),String.format(i,t[0].UserName)):(r=_Ewa.ClientStringManager.a().c(81),String.format(r,t.length)):n.length===1?(u=_Ewa.ClientStringManager.a().c(82),String.format(u,n[0].UserName)):(f=_Ewa.ClientStringManager.a().c(83),String.format(f,n.length))};_Ewa.sU.prototype={e:null,h:null,d:null,b:null,f:null,c:null,a:function(n,t){var i,r,u,f;return this.b=[],this.d.e(n,t,u={val:i},f={val:r}),i=u.val,r=f.val,Array.addRange(this.b,i),Array.addRange(this.b,r),_Ewa.sU.a(i,r)},dispose:function(){this.d.h(this.g);this.c&&(System.a.a(this.c),this.c=null);_Ewa.biZ.prototype.dispose.call(this)},i:function(n,t){var s,h,l,a,f,y,p;if(t.b){var i=[],r=[],u=_Ewa.c.a(this.e).a(),e=!(u.c()===2||u.c()===128),o;o=e?_Ewa.h.C(u.a().b(),this.e):u.b().a().a();s=t.b;for(h in s)l={key:h,value:s[h]},a=l.key,this.d.c(o,e,i,r,a);for(var v=this.b,w=v.length,c=0;c<w;++c)f=v[c],Array.contains(i,f)||Array.contains(r,f)||this.d.c(o,e,i,r,f.UserID);this.b=[];Array.addRange(this.b,i);Array.addRange(this.b,r);this.f&&(System.a.a(this.c),this.c=null,this.f=null);y=_Ewa.sU.a(i,r);this.c=new _Ewa.gE;p=this;this.f=_Ewa.g.a($$sc.a.b(1),function(){p.h.d(y,"polite")},this.c.a(),3,null,null)}}};_Ewa.sU.registerClass("_Ewa.sU",_Ewa.biZ,_Ewa.pF);Type.registerNamespace("_Ewa");_Ewa.Xc=function(){};_Ewa.Xc.b=function(){_Ewa.m.a(_Ewa.Xc.a)};_Ewa.Xc.a=function(n){var t=n.a(),i=_Ewa.l.b(_Ewa.cy,n.a(),211,212,1,null);t.c(_Ewa.lL,25,function(r){_Ewa.g.a(i,function(i){var u=t.a(_Ewa.pF,231,!1,null)||new _Ewa.sU(i.a(),n,r)},t.d(),3,null,null)},null)};_Ewa.Xc.b();Type.registerNamespace("_Ewa");_Ewa.Bt=function(n){this.p=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_Ewa.Bt.initializeBase(this,[!1]);this.l=n;this.l.D(this.n);this.l.b().bl(this.n);var t=this;n.a().c(Common.hF,38,function(n){n.g(t.n)},null)};_Ewa.Bt.a=function(n){n.a().b(_Ewa.kt,26,new _Ewa.Bt(n))};_Ewa.Bt.prototype={l:null,o:null,r:null,b:function(n){this.eo("connectionCompleted",n)},c:function(n){this.ep("connectionCompleted",n)},h:function(n){this.eo("rtcInitialized",n)},d:function(n){this.ep("rtcInitialized",n)},g:function(n){this.eo("connectionLostEventKey",n)},k:function(n){this.ep("connectionLostEventKey",n)},m:null,j:function(){return this.m},q:!1,i:function(){return this.q},dispose:function(){this.m&&this.m.h(this.p);this.l&&this.l.J(this.n);this.l=null;this.m=null;_Ewa.bW.prototype.dispose.call(this)},f:function(n){var t=this;_Ewa.g.a(this.s().a,function(t){n(t.a())},this.er(),3,null,null)},e:function(n,t){this.q=t;this.u(n)},a:function(){this.m&&(this.em("rtcInitialized",null,null),this.m.g()===2&&this.o&&this.em("connectionCompleted",new _Ewa.wf(this.m),this.o))},u:function(n){var i,r,t;Diag.a.a(9245249,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");i=[];i.push(_Ewa.v.b.a(42));i.push(_Ewa.v.b.a(43));i.push(Common.a.bt(_Ewa.v.b.a(10),0));this.l.e().StatusBarEnvironmentNameToUse==="Dev Box"&&Common.k.b(window.location.href,"wdjs",!1)==="local"&&(i[2]="https://localhost:8080/Ewa.Debug.rt.js");r=_Ewa.v.k(i,4,this.l.g(),1,0);t=this;_Ewa.g.a(r,function(){var r,u,i;Diag.a.a(571770433,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",isNullOrUndefined(AppRealtimeChannel.n));_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(r=(new Date).getTime(),_Ewa.g.a(_Ewa.l.b(_Ewa.fI,t.l.a(),435,436,1,null),function(n){var t=n.a();t.h(r)},t.l.g(),3,null,null));t.m=AppRealtimeChannel.n.c(n,t.l.e().UserSessionId,Common.a.ex,Common.a.e,null,2,_Ewa.D.a().o(),t.l.k().RtcEndpointUrl,null,new AppRealtimeChannel.g,null,null,t.l.k().RtcBootToken);Diag.a.a(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");t.s().b(t.m);_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(u=(new Date).getTime(),_Ewa.g.a(_Ewa.l.b(_Ewa.fI,t.l.a(),435,436,1,null),function(n){var i=n.a();i.g(t.q,u)},t.l.g(),3,null,null));t.em("rtcInitialized",null,null);Diag.a.a(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");i=$$as(AppRealtimeChannel.d,t.m);i&&(Diag.a.a(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),i.e(t.p),i.l())},this.er(),3,null,null)},t:function(n,t){if(t.a===2){if(this.m){if(_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var i=(new Date).getTime(),r=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fI,this.l.a(),435,436,1,null),function(n){var t=n.a();t.f(i)},this.l.g(),3,null,null)}this.em("connectionCompleted",new _Ewa.wf(this.m),t)}else Diag.a.a(38396034,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");this.o=t}else t.b!==2&&t.a||(this.o=null,this.em("connectionLostEventKey",null,null))},v:function(){if(this.m){var n=$$as(AppRealtimeChannel.d,this.m);n&&(Diag.a.a(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),n.m(),n.h(this.p))}this.m=null},s:function(){return this.r||(this.r=new($$sc.D.$$(Common.em)))}};_Ewa.Bt.registerClass("_Ewa.Bt",_Ewa.bW,_Ewa.kt,_Ewa.bmS);Type.registerNamespace("_Ewa");_Ewa.bpV=function(){};_Ewa.bpV.a=function(){_Ewa.m.a(_Ewa.Bt.a)};_Ewa.bpV.a();Type.registerNamespace("_Ewa");_Ewa.Wv=function(n,t,i,r){this.v=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.A);this.u=Function.createDelegate(this,this.B);_Ewa.Wv.initializeBase(this,[n,null]);var u="<div id='notificationBody'>\r\n<div class='clip16x16' id='notificationUserImage'><img class='{0}' src='{1}' id='singleUserImage'/><img class='{2}' src='{3}' id='multiUserImage'/><\/div>\r\n<span class='ewa-new-user-notification-text' id='notificationText'><\/span>\r\n<div class='clip16x16' id='notificationImage'><img class='{4}' src='{5}' alt='{6}' title='{6}' /><\/div>\r\n<\/div>\r\n";this.d=i;this.j=t;this.o=_Ewa.a.a("OfficeVSO:3862029_NarratorAnnounceEntry");u=String.format(u,"ewaboot_presenceheads",_Ewa.v.a(3),"ewaother_PlaceContacts_16x16x32",_Ewa.v.a(3),"ewaother_ClosePaneGlyph_16x16x32",_Ewa.v.a(3),this.d.a(751));this.cu().innerHTML=u;this.e=_Ewa.b.a(n,"notificationBody");this.b=_Ewa.b.a(n,"notificationText");this.f=_Ewa.b.a(n,"notificationImage");this.c=_Ewa.b.a(n,"notificationUserImage");this.m=_Ewa.b.a(n,"singleUserImage");this.k=_Ewa.b.a(n,"multiUserImage");_Ewa.b.j(this.b,"alert",null,null,null);this.cB().a("click",this.u,!1);this.i=this.cD.a(this.f);this.i.a("click",this.t,!1);this.q=r};_Ewa.Wv.prototype={e:null,b:null,f:null,c:null,m:null,k:null,i:null,n:null,r:null,s:null,a:null,g:!1,j:null,l:null,q:null,d:null,y:!1,o:!1,dispose:function(){System.a.b([this.i,this.l]);this.e=this.b=this.f=null;this.c=null;_Ewa.bgh.prototype.dispose.call(this)},h:function(n){n?this.set_visible(!0):(this.set_visible(!1),this.z())},D:function(n){this.cu().className=n?"ewa-popup-rtl ewa-new-user-notification":"ewa-popup-ltr ewa-new-user-notification";this.cu().dir=n?"rtl":"ltr";n?(this.e.insertBefore(this.b,this.c),this.e.insertBefore(this.f,this.b),this.c.style.marginLeft="10px"):(this.e.insertBefore(this.c,this.b),this.e.insertBefore(this.b,this.f),this.c.style.marginRight="10px")},p:function(n,t){var i;if(n&&n.length){var e=!this.n,r=new($$sc.w.$$(Boolean)),u=new($$sc.w.$$(Boolean)),f=new($$sc.w.$$(Boolean));for(i=0;i<n.length;i++)e?this.w(n[i].User.UserID):this.n.c(n[i].User.UserID)||(this.w(n[i].User.UserID),this.F(n[i],t)&&this.E(n[i])),r.a(n[i].User.UserID,!0),n[i].UserEmail&&u.a(n[i].UserEmail,!0),n[i].User.UserName&&f.a(n[i].User.UserName,!0);this.n=r;this.r=u;this.s=f}},F:function(n,t){return t?(Diag.a.a(37261332,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmailAvailable: [{0}], UserNameAvailable: [{1}]",!!n.UserEmail,!!n.User.UserName),n.User.UserName&&this.s.c(n.User.UserName))?(Diag.a.a(37261333,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserNameKnown]"),!1):n.UserEmail&&this.r.c(n.UserEmail)?(n.UserEmail.length||Diag.a.a(37261334,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmail is empty"),Diag.a.a(37261335,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserEmailKnown]"),!1):(Diag.a.a(37261336,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [UserEmailAndNameNotKnown]"),!0):(Diag.a.a(37261331,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [DedupDisabled]"),!0)},w:function(n){var t={};t.a=this.q;t.b=n;t.c="JoiningUser";t.d=_Ewa.r.a().a();_Ewa.D.a().a(23,t,!0)},E:function(n){if(this.a){var t=!_Ewa.f.g(this.a.User.UserID,n.User.UserID,!1);t||this.g||(this.g=!0,this.x())}else this.a=n,this.x()},x:function(){var n="",t;if(!this.y){this.g?n=this.d.a(750):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName));n!==""&&this.o&&(t=this,_Ewa.g.a(_Ewa.l.b(_Ewa.cy,this.j.a(),211,212,0,null),function(t){var i=t.a();i.b(!0);i.a(n)},this.j.g(),3,null,null));return}this.g?(n=this.d.a(750),this.c.style.backgroundColor="",_Ewa.b.b(this.m,!1,!0),_Ewa.b.b(this.k,!0,!0)):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName),this.c.style.backgroundColor=this.a.UserColor,_Ewa.b.b(this.m,!0,!0),_Ewa.b.b(this.k,!1,!0));this.b.innerText=n;System.a.a(this.l);this.l=_Ewa.A.a().a(this.v,5e3,_Ewa.o.cy,!0,!1);this.h(!0)},z:function(){this.a=null;this.g=!1},C:function(){this.h(!1)},B:function(n){this.h(!1);_Ewa.L.a(n,!0)},A:function(n){this.h(!1);_Ewa.L.a(n,!0)}};_Ewa.kp=function(n,t,i,r,u,f,e,o){var l,s,a,h,c;if(this.s=Function.createDelegate(this,this.S),this.r=Function.createDelegate(this,this.R),_Ewa.kp.initializeBase(this,[n,f,e,o]),this.b=t,this.u=i,this.t=r,this.v=u,this.b.b().Q(this.r),this.b.D(this.s),l=document.createElement("div"),_Ewa.c.a(this.b).H().appendChild(l),this.e=new _Ewa.Wv(l,this.b,u,this.b.e().UserSessionId),this.e.h(!1),this.e.D(this.b.u()),s=this.b.b().u(),this.u.i())for(a=s.length,h=0;h<a;h++)if(s[h].User.UserID===t.k().ClientId){this.e.p([s[h]],!0);break}this.e.p(s,!0);this.w=_Ewa.a.a("OfficeVSO:3552310_NoRefreshOnDisposedPeopleWell");_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.b.b()&&this.b.b().bb()&&(c=this,this.i.a.CW(function(){_Ewa.g.a(_Ewa.l.b(_Ewa.fI,c.b.a(),435,436,1,null),function(n){var t=n.a();t.b(c.i.a.a())},c.b.g(),3,null,null)}))};_Ewa.kp.a=function(n){var i=null,t;return n&&(t=n.SelectedRange,i=t&&t.length>0?t[0]:null),i};_Ewa.kp.prototype={z:5,e:null,t:null,u:null,v:null,b:null,o:!1,w:!0,y:function(){return _Ewa.a.a("OfficeVSO:5379420_ValidateAppNotClosingOnUserListUpdated")&&(this.o||this.b.V()||this.b.bC()||Sys.Application.get_isDisposing())},dispose:function(){var n=this.b;n&&(n.b().T(this.r),n.J(this.s),this.d.c([]),this.x(),n.h().u(46),_Ewa.sP.a(n));RealtimePresenceUI.b.prototype.dispose.call(this);this.o=!0},L:function(n){return this.bj(n)},M:function(n){return this.bo(n)},K:function(n){return this.bi(n)},G:function(){return this.g?this.g.a():[]},J:function(){},I:function(n,t){var i=_Ewa.kp.a(t),r,u;i&&(r=i.SheetName,r&&(u=_Ewa.h.b(i),this.b.d().r(this.b.d().b(r)),_Ewa.c.a(this.b).K(u,3,_Ewa.I.E,!1,null)))},C:function(n,t){var i=_Ewa.kp.a(t);return!!i&&!i.NamedObjectName},E:function(n,t,i){var o=i,f=_Ewa.kp.a(o),u,l,g,e,a,v,y,tt;if(!f)return"";var r="",p=f.SheetName,h=$$as(_Ewa.H,this.b.i()),w=!h||p!==h.N;w&&(r=String.format("{0}",p));var b="!",k=w?b.toString():"",s=!1;try{if(!(o.Version===1)&&o.Object){for(var d=o.Object,it=d.length,c=0;c<it;++c)if(u=d[c],l=this.Q(u),this.O(u)||this.N(u)||l){if(g=this.b.m(),e=g.bE(u.ObjectId),e){r=h&&h.N!==e.P?String.format("{0}{1}",e.P,b):"";r+=l?e.O.toString():e.N;s=!0;break}}else if(this.P(u)&&(a=_Ewa.U.a(this.b).f(u.ObjectId),a)){r=a.a().l;s=!0;break}Diag.a.a(25031572,0,50,"PresenceObject")}!s&&f.NamedObjectName&&o.Version===1&&(v=_Ewa.U.a(this.b).a(f.NamedObjectName,null),v&&(r+=k+v.a().l,s=!0));s||f.NamedObjectName||(y=_Ewa.h.b(f),y.v()&&(r+=k+y))}catch(nt){Diag.a.a(25031575,0,10,'{{"ConvertUserPresenceToStatusString Exception":"{0}"}',nt.stack);throw nt;}return tt=this.v.a(1244),String.format("{0} {1}",tt,r)},x:function(){if(this.w&&this.o){Diag.a.a(50665499,0,50,"EwaPeoplesWellControl.RefreshControlViewImpl: skipping since instance is already disposed.");return}if(this.y()){Diag.a.a(543270669,0,50,"EwaPeoplesWellControl.RefreshControlViewImpl: skipping since app is closing");return}if(_Ewa.p.a()){var n=_Ewa.bM.a(this.b);n&&n.a()&&n.a().l()}else this.t.k(this.c.a.f,!0)},R:function(){var n,r,u;if(this.y()){Diag.a.a(543270668,0,50,"EwaPeoplesWellControl.OnUserListUpdated: skipping since app is closing");return}Diag.a.a(23643289,0,50,"EwaPeoplesWellControl::OnUserListUpdated");this.k();this.e.p(this.b.b().u(),!0);n="";for(var i=this.b.b().u(),f=i.length,t=0;t<f;++t)r=i[t],n+=r.User.UserID+";";_Ewa.f.d(n)||Diag.a.a(25049093,0,50,"EwaPeoplesWellControl.OnUserListUpdated: UserList updated [{0}].",n);u=this.b.b().u().length;u>this.z&&this.b.v(1175817425,-1,0,null)},S:function(){this.b.a().e(Sys.IDisposable,45,null)},O:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.p(1)},N:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.p(0)},Q:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.p(2)},P:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.p(9)},p:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.Wu=function(n,t){this.b=n;this.a=t};_Ewa.Wu.prototype={b:null,a:null,B:function(){return!1},z:function(n,t,i){var u=this.a.c,f=null,r=t.a,e;return Diag.a.a(23643291,0,50,"EwaPeoplesWellControlHandler::ExecuteCommand: {0}",r),r===u.a.b?(e=this,f=_Ewa.g.a($$sc.a.b(0),function(){e.a.bl()},this.b.g(),3,null,null)):r===u.a.d?this.a.L(i):r===u.a.c?this.A(n,"PopulatePeoplesWellControl",i):r===u.a.e?this.a.M(i):r===u.a.g?this.a.k():f=_Ewa.Y.a(r),f||$$sc.a.a(Boolean,!0)},y:function(n,t,i){var r=this.a.c,f=!1,u=t.a;return u===r.a.b||u===r.a.g?f=!0:(u===r.a.d||u===r.a.c||u===r.a.e)&&(f=!!i),f},A:function(n,t,i){return t==="PopulatePeoplesWellControl"?(this.a.K(i),!0):!1},dispose:function(){this.b&&this.b.h()&&this.b.h().h(this);this.b=null}};_Ewa.sP=function(n){this.v=Function.createDelegate(this,this.z);this.s=Function.createDelegate(this,this.y);_Ewa.sP.initializeBase(this,[n])};_Ewa.sP.a=function(n){_Ewa.bg.a(46,new _Ewa.sP(n))};_Ewa.sP.prototype={t:!1,r:null,p:null,dispose:function(){this.p&&this.p.d(this.s);this.t=!1;this.r=null;this.p=null;var n=this.i;n&&n.C(this.v);_Ewa.bg.prototype.dispose.call(this)},m:function(){Diag.a.a(23643293,0,50,"PeoplesWellCommandHandlerFactory::CreateCommandHandlersAsync. SessionAction: {0}, EditMode {1}",this.i.b().a(),this.i.j());this.i.b().a()&&this.i.j()?this.w():this.i.B(this.v)},z:function(n,t){t.a||this.w()},y:function(){var t,r,f;Diag.a.a(38410441,0,50,"PeoplesWellCommandHandlerFactory::OnRealTimeChannelInitialized");this.p.d(this.s);var u=this.r.q(_Ewa.v.a(3),"ewaboot_presenceheads",_Ewa.v.a(3),"ewaboot_presenceheads32",_Ewa.v.a(3),"ewaboot_presenceheadswhite"),i=$$as(AppRealtimeChannel.d,this.p.j()),n=this;Common.Utils.a.a().c(_Ewa.kp,null).c(Common.el,null).a().b(function(){var t=i,r=i;return new _Ewa.kp(RealtimePresenceUI.a.a(u,n.i.k().ClientId,t.c||(t.c=Function.createDelegate(t,t.n)),r.d||(r.d=Function.createDelegate(r,r.o)),!0),n.i,n.p,n.r,_Ewa.ClientStringManager.a(),Common.Utils.a.a().a(Common.App.People.b,null),Common.Utils.b.a(Common.cf,Common.Utils.a.a().b(Common.cf,null)),Common.Utils.b.a(Common.App.SkypeChat.a,Common.Utils.a.a().b(Common.App.SkypeChat.a,null)))});t=Common.Utils.a.a().a(Common.el,null);this.i.a().b(Sys.IDisposable,45,t);_Ewa.a.a("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(r=(new Date).getTime(),f=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fI,this.i.a(),435,436,1,null),function(n){var t=n.a();t.a(r)},this.i.g(),3,null,null));this.n([new _Ewa.Wu(this.i,t)],null)},w:function(){Diag.a.a(23643294,0,50,"PeoplesWellCommandHandlerFactory::InitPeoplesWellControl");var t=this.i.a(),n=this;t.c(_Ewa.kt,26,function(i){t.c(_Ewa.cg,53,function(r){_Ewa.g.a(_Ewa.l.a(Object,t,155,n.h(),n.j,null),function(){n.p=i;n.r=r;n.x()},n.h(),3,null,null)},null)},null)},x:function(){this.t||(Diag.a.a(50469021,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - attach RealTimeChannelInitialized handler"),this.p.h(this.s),this.t=!0);Diag.a.a(50469022,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - check connection");this.p.a()}};_Ewa.Wv.registerClass("_Ewa.Wv",_Ewa.bgh);_Ewa.kp.registerClass("_Ewa.kp",RealtimePresenceUI.b);_Ewa.Wu.registerClass("_Ewa.Wu",null,_Ewa.lF,Sys.IDisposable);_Ewa.sP.registerClass("_Ewa.sP",_Ewa.bg);Type.registerNamespace("_Ewa");_Ewa.boW=function(){};_Ewa.boW.a=function(){_Ewa.m.a(_Ewa.sP.a)};_Ewa.boW.a();Type.registerNamespace("_Ewa");_Ewa.XC=function(n){this.d=n};_Ewa.XC.prototype={d:null,a:function(n){return n},b:function(n){return _Ewa.jh.a(this.d.c().a(),n.b,n.a,n.c,null,null,null,null)},c:function(n,t){if(!t)return n;if(!n)return Diag.a.b(39913247,0,!!n,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t;if(t.b!==n.b)return Diag.a.a(39913248,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. newActionParameter.SeqNum: {0}, aggregatedActionParameter.seqNum: {1}",n.a,t.a),n.a<t.a?n:t;var i=n.a>t.a?n.a:t.a;return new _Ewa.Bu(n.b,i,n.c)}};_Ewa.XD=function(n){this.d=n};_Ewa.XD.prototype={d:null,a:function(n){return n},b:function(n){return _Ewa.jh.b(this.d.c().a(),n.b,n.a,n.c,null,null,null,null)},c:function(n,t){return t?n?(n.a=!!(n.a&t.a),n):(Diag.a.b(40195267,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t):n}};_Ewa.XE=function(n){this.d=n};_Ewa.XE.prototype={d:null,a:function(n){return n},b:function(n){return _Ewa.jh.e(this.d.c().a(),n.b,n.c,n.a,null,null,null,null,null)},c:function(n,t){return t?n?n:(Diag.a.b(544215616,0,!!n,"UploadNotificationActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t):n}};_Ewa.Bu=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.Bu.prototype={b:null,a:0,c:null};_Ewa.XG=function(n,t,i,r,u,f){this.m=Function.createDelegate(this,this.B);this.n=Function.createDelegate(this,this.F);this.q=Function.createDelegate(this,this.D);this.p=Function.createDelegate(this,this.C);this.r=Function.createDelegate(this,this.G);_Ewa.XG.initializeBase(this,[!1]);this.i=n;this.k=t;this.i.c().d(this.r);this.k.b(this.p);this.k.g(this.q);this.t=i;this.u=r;this.v=u;this.w=f;this.k.a()};_Ewa.XG.prototype={j:null,i:null,k:null,o:!1,t:null,u:null,v:null,w:null,e:function(n){this.eo("ekcrmrrg",n)},g:function(n){this.ep("ekcrmrrg",n)},a:function(n){this.eo("ekcrmmcu",n)},c:function(n){this.ep("ekcrmmcu",n)},d:function(n){this.eo("LabelUpdateEventKey",n)},f:function(n){this.ep("LabelUpdateEventKey",n)},s:null,b:function(){return this.s},z:function(){return!!this.j&&this.j.g()===2},h:function(n,t){this.i.b().a()&&(Diag.a.a(39150978,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",n?n.join(","):"null",t?t.join(","):"null"),this.v.a(new _Ewa.XK(n,t,null)))},dispose:function(){this.j&&this.j.j(this.n);this.i&&this.i.c().e(this.r);this.k&&(this.k.c(this.p),this.k.k(this.q));this.j=null;this.i=null;_Ewa.bW.prototype.dispose.call(this)},I:function(n){this.j&&this.j.j(this.n);this.j=$$as(AppRealtimeChannel.d,n);this.j.a(this.n)},F:function(n,t){var i,u,c,v,y,p,w,r,b,k,d,e,l,o,s,g,nt,tt,it,h,f,a,rt,ut,ft,et,ot,st,ht,ct;if(this.o=!0,i=$$as(Object,t.b),t.a===1){u=$$as(Array,t.b);!u&&i&&(u=$$as(Array,i.Editors));(!u||this.H(u))&&this.h(u,null);return}if(i)if(t.a){if(t.a===3){if(!("PresenceType"in i)){Diag.a.a(590751315,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}if(r=i.PresenceType,r===2)this.A(i);else if(r===5){if(_Ewa.a.c("Microsoft.Office.Excel.HandleFullSaveStartedRTC",!1)){if(d=this.l(i,k={val:b}),b=k.val,d)return;e=i.FullSaveId;!e||!e.length||(Diag.a.a(553654083,0,50,"RTC : FullSaveStarted received. Now invoking ProcessFullSaveStartedNotification web method"),_Ewa.jh.d(this.i.c().a(),e,null,null,null,null,null))}}else r===6||r===7||r===8?_Ewa.a.c("Microsoft.Office.Excel.HandleUploadNotificationsRTC",!1)&&(l=0,r!==8&&(l=i.SavRev),o=i.ClientId,!o||!o.length||(Diag.a.a(544215587,0,50,"RTC : {0} received. Now invoking ProcessUploadNotification web method.",r),this.w.a(new _Ewa.XL(r,l,o,this.m)))):r===9||Diag.a.a(590751313,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",r);return}if(t.a===4){if(s=!1,"OnBehalfOfOcs"in i&&(s=i.OnBehalfOfOcs),it=(tt=this.l(i,nt={val:g}),g=nt.val,tt),it)return;if(this.i.b().ct()&&this.y(),this.i.b().W()&&s)return;h=i.Id;!this.i.b().a()||!h||!h.length||this.u.a(new _Ewa.XH(h,s,this.m))}else t.a===8&&(f=i.SessionId,a=i.SeqNum,!this.i.b().a()||!f||!f.length||(_Ewa.a.b(512)?_Ewa.jh.a(this.i.c().a(),f,a,this.m,null,null,null,null):this.t.a(new _Ewa.Bu(f,a,this.m))))}else p=(y=this.l(i,v={val:c}),c=v.val,y),p?(this.E(i),"latestStateId"in i&&(w=i.latestStateId,this.i.b().O(w,"ContentRefreshManager.OnUpdateNotificationReceived"),this.x())):Diag.a.a(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",c,this.i.b().bt());if(t.a===2){if(i&&(et=(ft=this.l(i,ut={val:rt}),rt=ut.val,ft),et))return;Diag.a.a(42267869,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method");_Ewa.jh.c(this.i.c().a(),null,null,null,null,null)}else if(_Ewa.a.b(567)&&t.a===12){if(i&&(ct=(ht=this.l(i,st={val:ot}),ot=st.val,ht),ct))return;this.em("LabelUpdateEventKey",null,null)}},A:function(n){var t,i,r,u,f,e;if(!("GeneratedXluid"in n)||!("CollabMode"in n)||!("ClientType"in n)){Diag.a.a(40154954,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.");return}(t=n.ClientType,t!==1||"sessionSiteIdentifier"in n&&"CommandTimeInMs"in n||Diag.a.a(40182808,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.","sessionSiteIdentifier"in n,"CommandTimeInMs"in n),f=(u=this.l(n,r={val:i}),i=r.val,u),f)||(e=new _Ewa.XI(n.GeneratedXluid,n.CollabMode,t,i,"CommandTimeInMs"in n?n.CommandTimeInMs:0),this.em("ekcrmrrg",e,this))},l:function(n,t){t.val="sessionSiteIdentifier"in n?n.sessionSiteIdentifier:null;var i=this.i.b().bt();return i===t.val},B:function(n){var t=n.Errors,i,r;_Ewa.j.e(t)?(t=_Ewa.j.f(t,[1552731907],"ContentRefreshManager"),_Ewa.j.i(t)||this.i.b().p(t)):(i=n.Result,r=n.StateId+1,i&&this.i.b().d()<r&&this.i.b().O(-1,"ContentRefreshManager.OnCheckForUpdateSuccess"))},G:function(){this.z()&&this.o&&this.i.b().bC()&&this.x()},x:function(){this.i.b().bT(Math.max(3e4,this.i.b().bK()))},D:function(){this.o=!1;this.i.b().bT(500);this.s=_Ewa.r.a().a()},C:function(n,t){this.I(t.a)},H:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;++t)if(r=i[t],u=this.i.b().bN(r),!u)return!0;return!1},y:function(){this.i.v(1562177611,-1,0,null)},E:function(n){if(!("MrgCur"in n)||!("MrgNxt"in n)||!("MrgSusStart"in n)){"MrgCur"in n&&!("MrgSusStart"in n)&&Diag.a.a(542782029,0,10,"ContentRefreshManager.OnMergeCounterReceivedFromServer: Received updateHint with MergeCurrent but without MergeSuspensionStartTimestamp");return}var t,i=(t=new _Ewa.qu,t.Pending=n.MrgNxt,t.Current=n.MrgCur,t.SuspensionStartTimestamp=n.MrgSusStart,t);this.em("ekcrmmcu",new _Ewa.Bv(i),this)}};_Ewa.XH=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.XH.prototype={b:null,a:!1,c:null};_Ewa.XJ=function(n){this.d=n};_Ewa.XJ.prototype={d:null,a:function(n){return n+5e3},b:function(n){if(!this.d.b().a())return $$sc.a.a(Boolean,!0);var t=this,i=this;return _Ewa.g.ts(_Ewa.g.ts($$sc.a.b(0),function(){return _Ewa.jh.f(t.d.c().a(),n.e(),n.f(),n.d,null,null,null,null)},$$sc.f.a,0,$$sc.c.a),function(){return $$sc.a.b(5e3)},$$sc.f.a,0,$$sc.c.a)},c:function(n,t){return t?n?t.g()?t:n.g()?n:(t.h(n),t):(Diag.a.b(578339170,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),t):n}};_Ewa.XK=function(n,t,i){this.b={};this.c={};this.d=i;this.a(n,this.b);this.a(t,this.c)};_Ewa.XK.prototype={e:function(){return $$sc.j.a(this.b)},f:function(){return $$sc.j.a(this.c)},d:null,g:function(){return!this.e().length&&!this.f().length},h:function(n){this.a(n.e(),this.b);this.a(n.f(),this.c)},a:function(n,t){var u;if(n)for(var r=n,f=r.length,i=0;i<f;++i)u=r[i],t[u]=!0}};_Ewa.XL=function(n,t,i,r){this.b=n;this.a=i;this.c=t;this.d=r};_Ewa.XL.prototype={b:0,a:null,c:0,d:null};_Ewa.XF=function(n){var i,r,t;this.y=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.F);this.r=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.J);this.p=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.I);this.v=Function.createDelegate(this,this.C);this.z=Function.createDelegate(this,this.P);_Ewa.XF.initializeBase(this,[!1]);this.a=n;this.i=_Ewa.c.a(this.a).b();this.j=_Ewa.c.a(this.a).j();this.d=this.a.a().a(_Ewa.ia,292,!1,null);this.g=this.a.E();this.c=new($$sc.v.$$(_Ewa.um));this.b=new($$sc.s.$$(_Ewa.og));i=_Ewa.a.b(299)?1e3:3e4;this.f=_Ewa.A.a().b(this.z,i,_Ewa.o.M,!1,!1);this.a.B(this.v);this.a.b().g(this.t);this.a.b().bl(this.p);r=this;this.a.a().c(_Ewa.dH,291,function(n){r.h=n},null);t=this;this.a.a().c(_Ewa.kh,343,function(n){t.w||(t.e=n,t.e.a(t.u),t.e.c())},null);Diag.a.a(571798802,13,50,"ContentLatencyTracker initialized");this.C(this.a,null)};_Ewa.XF.prototype={a:null,i:null,j:null,d:null,g:null,h:null,e:null,k:!1,o:null,f:null,w:!1,n:!1,l:!1,m:!1,c:null,b:null,dispose:function(){this.w=!0;this.f&&(this.f.dispose(),this.f=null);this.d&&(this.D(),this.d=null);this.i&&(this.x(),this.i=null);this.j&&(this.x(),this.j=null);this.g&&(this.g=null);this.a&&(this.a.C(this.v),this.a.b().j(this.t),this.a.b().bQ(this.p),this.a=null);this.e&&(this.e.d(this.u),this.e=null);_Ewa.biZ.prototype.dispose.call(this)},J:function(n,t){this.k!==t.a&&(this.k=t.a,this.o=this.k?null:_Ewa.r.a().a())},C:function(){this.a.j()&&this.N()},I:function(n,t){t.d||this.A(n,t)},A:function(){(this.c.f.length>0||this.b.f>0)&&(Diag.a.a(40154958,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",this.c.f.length,this.b.f),this.c.h(),this.b=new($$sc.s.$$(_Ewa.og)));this.f.a();this.D();this.x();this.O()},G:function(n,t){this.L();this.M();var i=new _Ewa.um;i.Xluid=t.e;i.NotificationReceivedOn=_Ewa.r.a().a().toISOString();i.CurrentPresenceUserCount=this.a.b().u().length;i.OurCollabModeIsUsingOcs=this.a.b().W();i.SenderCollabMode=t.c;i.SenderClientType=t.b;i.SessionSiteIdentifier=t.d;i.CommandTimeInMs=t.a;Diag.a.a(40154959,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(i));this.c.b(i)},N:function(){this.n||(this.d.e(this.r),this.n=!0,this.f.b(-1))},D:function(){this.n&&(this.d.g(this.r),this.n=!1)},L:function(){this.l||(this.i.c(this.q),this.l=!0)},x:function(){this.l&&(this.i.d(this.q),this.l=!1)},M:function(){this.m||(this.j.j(this.s),this.m=!0)},O:function(){this.m&&(this.j.n(this.s),this.m=!1)},F:function(){var n=this.a.b().d();this.B(n,"OnBlockCacheConsistent")},H:function(n,t){var i=$$as(_Ewa.lj,t.a),r;i&&(r=i.p(),this.B(r,"OnRenderedContent"))},B:function(n,t){if(n!==-1&&!this.b.c(n)){var u=_Ewa.r.a().a().toISOString(),i,r=(i=new _Ewa.og,i.StateId=n,i.DownloadedOn=u,i.IsHidden=this.h?this.h.a():window.document.visibilityState!=="visible",i.DocumentLastUnhidden=this.h&&this.h.h()?this.h.h().toISOString():null,i.LastLostRtcConnection=this.d&&this.d.b()?this.d.b().toISOString():null,i.LastOffline=this.g&&this.g.b()?this.g.b().toISOString():null,i);this.e&&(r.IsPendingMergeBlockedByClient=this.k,this.o&&(r.PendingMergeBlockedByClientLastEnded=this.o.toISOString()));Diag.a.a(41685216,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",t,JSON.stringify(r));this.b.d(n,r)}},P:function(){var t,n,r,i,u;if(!this.a.b().a()){Diag.a.a(571245763,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");return}if(this.c.f.length||this.b.f){if(t=null,this.c.f.length>0&&(t=this.c.g(),this.c.h()),n=null,this.b.f>0){for(n=new Array(this.b.f),r=0,i=this.b.l().$$ge();i.$$mn();)u=i.$$cu(),n[r++]=u;this.b=new($$sc.s.$$(_Ewa.og))}Diag.a.a(40154963,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",t?t.length:0,n?n.length:0);_Ewa.jh.g(this.a.c().a(),t,n,this.y,null,null,null,null)}},K:function(n){if(n.Result){var t=n.Result;t>0&&this.E()}},E:function(){Common.a.f&&(Common.a.f.HasReceivedInboundReplications=!0)}};_Ewa.bpW=function(){};_Ewa.bpW.a=function(){_Ewa.m.a(function(n){_Ewa.g.a(_Ewa.l.a(_Ewa.dg,n.a(),12,n.g(),0,null),function(t){var i=t,r=new _Ewa.XC(n),u=n.a().a(_Ewa.dH,291,!1,null),f=i.a().b(r,r,u,"collabService"),e=new _Ewa.XD(n),o=i.a().b(e,e,u,"persisted"),s=new _Ewa.XJ(n),l=i.a().b(s,s,null,"updatePresence"),h=new _Ewa.XE(n),c=i.a().b(h,h,null,"uploadNotification");n.a().b(_Ewa.ia,292,new _Ewa.XG(n,n.a().a(_Ewa.kt,26,!1,null),f,o,l,c));_Ewa.eQ.a(n.a()).a(new _Ewa.XF(n));_Ewa.eQ.a(n.a()).a(f);_Ewa.eQ.a(n.a()).a(o);_Ewa.eQ.a(n.a()).a(c)},n.g(),3,null,null)})};_Ewa.jh=function(){};_Ewa.jh.b=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.Id=t,s.OnBehalfOfOcs=i,_Ewa.k.a(n,"CheckPersistedContentUpdate",s,r,u,f,e,516,null,null)};_Ewa.jh.a=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.OcsSessionId=t,s.SeqNum=i,_Ewa.k.a(n,"CheckCollabServiceContentUpdate",s,r,u,f,e,516,null,null)};_Ewa.jh.d=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.fullSaveId=t,_Ewa.k.a(n,"ProcessFullSaveStartedNotification",o,i,r,u,f,0,null,null)};_Ewa.jh.e=function(n,t,i,r,u,f,e,o,s){var h=n.a(1,s);return h.rtcUpdateType=t,h.xrevidSaved=i,h.clientId=r,_Ewa.k.a(n,"ProcessUploadRtcNotification",h,u,f,e,o,0,null,null)};_Ewa.jh.f=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.clientIdsToAdd=t,s.clientIdsToRemove=i,_Ewa.k.a(n,"UpdatePresenceUsers",s,r,u,f,e,0,null,null)};_Ewa.jh.c=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"CheckWorkbookFileNameUpdate",e,t,i,r,u,0,null,null)};_Ewa.jh.g=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.GenerateNotifications=t,s.DownloadNotifications=i,_Ewa.k.a(n,"UploadLatencyTelemetry",s,r,u,f,e,128,null,null)};_Ewa.XG.registerClass("_Ewa.XG",_Ewa.bW,_Ewa.ia);_Ewa.XF.registerClass("_Ewa.XF",_Ewa.biZ);_Ewa.bpW.a();